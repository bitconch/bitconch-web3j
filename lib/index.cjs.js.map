{"version":3,"file":"index.cjs.js","sources":["../src/pubkey.js","../src/bus-account.js","../src/timing.js","../src/resize.js","../src/util/shortvec-encoding.js","../src/transaction-controller.js","../src/util/sleep.js","../src/connection.js","../src/util/send-and-confm-tx.js","../src/system-controller.js","../src/controller-loader.js","../src/bpfcontroller-loader.js","../src/budget-controller.js","../src/nativecontroller-loader.js","../src/token-controller.js","../src/util/send-and-confm-original-tx.js","../src/util/testnet.js","../src/index.js"],"sourcesContent":["// @flow\n\nimport BN from 'bn.js';\nimport bs58 from 'bs58';\n\n/**\n * A public key\n */\nexport class PubKey {\n  _bn: BN;\n\n  /**\n   * Create a new PubKey object\n   */\n  constructor(value: number | string | Buffer | Array<number>) {\n    if (typeof value === 'string') {\n      // hexadecimal number\n      if (value.startsWith('0x')) {\n        this._bn = new BN(value.substring(2), 16);\n      } else {\n        // assume base 58 encoding by default\n        this._bn = new BN(bs58.decode(value));\n      }\n    } else {\n      this._bn = new BN(value);\n    }\n\n    if (this._bn.byteLength() > 32) {\n      throw new Error(`Invalid public key input`);\n    }\n  }\n\n  /**\n   * Checks if the provided object is a PubKey\n   */\n  static isPubKey(o: Object): boolean {\n    return o instanceof PubKey;\n  }\n\n  /**\n   * Checks if two publicKeys are equal\n   */\n  equals(pubKey: PubKey): boolean {\n    return this._bn.eq(pubKey._bn);\n  }\n\n  /**\n   * Return the base-58 representation of the public key\n   */\n  toBase58(): string {\n    return bs58.encode(this.toBuffer());\n  }\n\n  /**\n   * Return the Buffer representation of the public key\n   */\n  toBuffer(): Buffer {\n    const b = this._bn.toArrayLike(Buffer);\n    if (b.length === 32) {\n      return b;\n    }\n\n    const zeroPad = Buffer.alloc(32);\n    b.copy(zeroPad, 32 - b.length);\n    return zeroPad;\n  }\n\n  /**\n   * Returns a string representation of the public key\n   */\n  toString(): string {\n    return this.toBase58();\n  }\n}\n","// @flow\nimport nacl from 'tweetnacl';\nimport type {KeyPair} from 'tweetnacl';\n\nimport {PubKey} from './pubkey';\n\n/**\n * An account key pair (public and secret keys).\n */\nexport class BusAccount {\n  _keypair: KeyPair;\n\n  /**\n   * Create a new BusAccount object\n   *\n   * If the privateKey parameter is not provided a new key pair is randomly\n   * created for the account\n   *\n   * @param privateKey Secret key for the account\n   */\n  constructor(privateKey: ?Buffer = null) {\n    if (privateKey) {\n      this._keypair = nacl.sign.keyPair.fromSecretKey(privateKey);\n    } else {\n      this._keypair = nacl.sign.keyPair();\n    }\n  }\n\n  /**\n   * The public key for this account\n   */\n  get pubKey(): PubKey {\n    return new PubKey(this._keypair.publicKey);\n  }\n\n  /**\n   * The **unencrypted** secret key for this account\n   */\n  get privateKey(): Buffer {\n    return this._keypair.secretKey;\n  }\n}\n","// @flow\n\n// TODO: These constants should be removed in favor of reading them out of a\n// Syscall account\n\n/**\n * @ignore\n */\nexport const NUM_TICKS_PER_SEC = 10;\n\n/**\n * @ignore\n */\nexport const DEFAULT_TICKS_PER_SLOT = 8;\n","// @flow\n\nimport * as BufferLayout from 'buffer-layout';\n\n/**\n * Layout for a public key\n */\nexport const pubKey = (property: string = 'pubKey'): Object => {\n  return BufferLayout.blob(32, property);\n};\n\n/**\n * Layout for a 64bit unsigned value\n */\nexport const uint64 = (property: string = 'uint64'): Object => {\n  return BufferLayout.blob(8, property);\n};\n\n/**\n * Layout for a Rust String type\n */\nexport const rustString = (property: string = 'string') => {\n  const rsl = BufferLayout.struct(\n    [\n      BufferLayout.u32('length'),\n      BufferLayout.u32('lengthPadding'),\n      BufferLayout.blob(BufferLayout.offset(BufferLayout.u32(), -8), 'chars'),\n    ],\n    property,\n  );\n  const _decode = rsl.decode.bind(rsl);\n  const _encode = rsl.encode.bind(rsl);\n\n  rsl.decode = (buffer, offset) => {\n    const data = _decode(buffer, offset);\n    return data.chars.toString('utf8');\n  };\n\n  rsl.encode = (str, buffer, offset) => {\n    const data = {\n      chars: Buffer.from(str, 'utf8'),\n    };\n    return _encode(data, buffer, offset);\n  };\n\n  return rsl;\n};\n","// @flow\n\nexport function decodeLength(bytes: Array<number>): number {\n  let len = 0;\n  let size = 0;\n  for (;;) {\n    let elem = bytes.shift();\n    len |= (elem & 0x7f) << (size * 7);\n    size += 1;\n    if ((elem & 0x80) === 0) {\n      break;\n    }\n  }\n  return len;\n}\n\nexport function encodeLength(bytes: Array<number>, len: number) {\n  let rem_len = len;\n  for (;;) {\n    let elem = rem_len & 0x7f;\n    rem_len >>= 7;\n    if (rem_len == 0) {\n      bytes.push(elem);\n      break;\n    } else {\n      elem |= 0x80;\n      bytes.push(elem);\n    }\n  }\n}\n","// @flow\n\nimport invariant from 'assert';\nimport * as BufferLayout from 'buffer-layout';\nimport nacl from 'tweetnacl';\nimport bs58 from 'bs58';\n\nimport * as Layout from './resize';\nimport {PubKey} from './pubkey';\nimport {BusAccount} from './bus-account';\nimport * as shortvec from './util/shortvec-encoding';\nimport type {Blockhash} from './bus-blockhash';\n\n/**\n * @typedef {string} TxnSignature\n */\nexport type TxnSignature = string;\n\n/**\n * Maximum over-the-wire size of a Transaction\n *\n * 1280 is IPv6 minimum MTU\n * 40 bytes is the size of the IPv6 header\n * 8 bytes is the size of the fragment header\n */\nexport const PACKET_DATA_SIZE = 1280 - 40 - 8;\n\n/**\n * List of TxOperation object fields that may be initialized at construction\n *\n * @typedef {Object} TxInstructionControlFields\n * @property {?Array<PubKey>} keys\n * @property {?PubKey} controllerId\n * @property {?Buffer} data\n */\ntype TxInstructionControlFields = {|\n  keys?: Array<{pubkey: PubKey, isSigner: boolean, isDebitable: boolean}>,\n  controllerId?: PubKey,\n  data?: Buffer,\n|};\n\n/**\n * Transaction Instruction class\n */\nexport class TxOperation {\n  /**\n   * Public keys to include in this transaction\n   * Boolean represents whether this pubkey needs to sign the transaction\n   */\n  keys: Array<{\n    pubkey: PubKey,\n    isSigner: boolean,\n    isDebitable: boolean,\n  }> = [];\n\n  /**\n   * Controller Id to execute\n   */\n  controllerId: PubKey;\n\n  /**\n   * Controller input\n   */\n  data: Buffer = Buffer.alloc(0);\n\n  constructor(opts?: TxInstructionControlFields) {\n    opts && Object.assign(this, opts);\n  }\n}\n\n/**\n * @private\n */\ntype SignaturePubkeyPair = {|\n  signature: Buffer | null,\n  pubKey: PubKey,\n|};\n\n/**\n * List of Transaction object fields that may be initialized at construction\n *\n * @typedef {Object} TxnControlFields\n * @property (?recentPackagehash} A recent block hash\n * @property (?signatures} One or more signatures\n *\n */\ntype TxnControlFields = {|\n  recentPackagehash?: Blockhash | null,\n  signatures?: Array<SignaturePubkeyPair>,\n|};\n\n/**\n * Transaction class\n */\nexport class Transaction {\n  /**\n   * Signatures for the transaction.  Typically created by invoking the\n   * `sign()` method\n   */\n  signatures: Array<SignaturePubkeyPair> = [];\n\n  /**\n   * The first (payer) Transaction signature\n   */\n  get signature(): Buffer | null {\n    if (this.signatures.length > 0) {\n      return this.signatures[0].signature;\n    }\n    return null;\n  }\n\n  /**\n   * The operations to atomically execute\n   */\n  operations: Array<TxOperation> = [];\n\n  /**\n   * A recent transaction id.  Must be populated by the caller\n   */\n  recentPackagehash: Blockhash | null;\n\n  /**\n   * Construct an empty Transaction\n   */\n  constructor(opts?: TxnControlFields) {\n    opts && Object.assign(this, opts);\n  }\n\n  /**\n   * Add one or more operations to this Transaction\n   */\n  add(\n    ...items: Array<\n      Transaction | TxOperation | TxInstructionControlFields,\n    >\n  ): Transaction {\n    if (items.length === 0) {\n      throw new Error('No operations');\n    }\n\n    items.forEach(item => {\n      if (item instanceof Transaction) {\n        this.operations = this.operations.concat(item.operations);\n      } else if (item instanceof TxOperation) {\n        this.operations.push(item);\n      } else {\n        this.operations.push(new TxOperation(item));\n      }\n    });\n    return this;\n  }\n\n  /**\n   * @private\n   */\n  _fetchSignData(): Buffer {\n    const {recentPackagehash} = this;\n    if (!recentPackagehash) {\n      throw new Error('Transaction recentPackagehash required');\n    }\n\n    if (this.operations.length < 1) {\n      throw new Error('No operations provided');\n    }\n\n    const keys = this.signatures.map(({pubKey}) => pubKey.toString());\n    let numRequiredSignatures = 0;\n    let numCreditOnlySignedAccounts = 0;\n    let numCreditOnlyUnsignedAccounts = 0;\n\n    const programIds = [];\n\n    this.operations.forEach(instruction => {\n      instruction.keys.forEach(keySignerPair => {\n        const keyStr = keySignerPair.pubkey.toString();\n        if (!keys.includes(keyStr)) {\n          if (keySignerPair.isSigner) {\n            numRequiredSignatures += 1;\n            if (!keySignerPair.isDebitable) {\n              numCreditOnlySignedAccounts += 1;\n            }\n          } else {\n            if (!keySignerPair.isDebitable) {\n              numCreditOnlyUnsignedAccounts += 1;\n            }\n          }\n          keys.push(keyStr);\n        }\n      });\n\n      const controllerId = instruction.controllerId.toString();\n      if (!programIds.includes(controllerId)) {\n        programIds.push(controllerId);\n      }\n    });\n\n    programIds.forEach(controllerId => {\n      if (!keys.includes(controllerId)) {\n        keys.push(controllerId);\n        numCreditOnlyUnsignedAccounts += 1;\n      }\n    });\n\n    if (numRequiredSignatures > this.signatures.length) {\n      throw new Error(\n        `Insufficent signatures: expected ${numRequiredSignatures} but got ${\n          this.signatures.length\n        }`,\n      );\n    }\n\n    let keyCount = [];\n    shortvec.encodeLength(keyCount, keys.length);\n\n    const operations = this.operations.map(instruction => {\n      const {data, controllerId} = instruction;\n      let keyIndicesCount = [];\n      shortvec.encodeLength(keyIndicesCount, instruction.keys.length);\n      let dataCount = [];\n      shortvec.encodeLength(dataCount, instruction.data.length);\n      return {\n        programIdIndex: keys.indexOf(controllerId.toString()),\n        keyIndicesCount: Buffer.from(keyIndicesCount),\n        keyIndices: Buffer.from(\n          instruction.keys.map(keyObj =>\n            keys.indexOf(keyObj.pubkey.toString()),\n          ),\n        ),\n        dataLength: Buffer.from(dataCount),\n        data,\n      };\n    });\n\n    operations.forEach(instruction => {\n      invariant(instruction.programIdIndex >= 0);\n      instruction.keyIndices.forEach(keyIndex => invariant(keyIndex >= 0));\n    });\n\n    let instructionCount = [];\n    shortvec.encodeLength(instructionCount, operations.length);\n    let instructionBuffer = Buffer.alloc(PACKET_DATA_SIZE);\n    Buffer.from(instructionCount).copy(instructionBuffer);\n    let instructionBufferLength = instructionCount.length;\n\n    operations.forEach(instruction => {\n      const instructionLayout = BufferLayout.struct([\n        BufferLayout.u8('programIdIndex'),\n\n        BufferLayout.blob(\n          instruction.keyIndicesCount.length,\n          'keyIndicesCount',\n        ),\n        BufferLayout.seq(\n          BufferLayout.u8('keyIndex'),\n          instruction.keyIndices.length,\n          'keyIndices',\n        ),\n        BufferLayout.blob(instruction.dataLength.length, 'dataLength'),\n        BufferLayout.seq(\n          BufferLayout.u8('userdatum'),\n          instruction.data.length,\n          'data',\n        ),\n      ]);\n      const length = instructionLayout.encode(\n        instruction,\n        instructionBuffer,\n        instructionBufferLength,\n      );\n      instructionBufferLength += length;\n    });\n    instructionBuffer = instructionBuffer.slice(0, instructionBufferLength);\n\n    const signDataLayout = BufferLayout.struct([\n      BufferLayout.blob(1, 'numRequiredSignatures'),\n      BufferLayout.blob(1, 'numCreditOnlySignedAccounts'),\n      BufferLayout.blob(1, 'numCreditOnlyUnsignedAccounts'),\n      BufferLayout.blob(keyCount.length, 'keyCount'),\n      BufferLayout.seq(Layout.pubKey('key'), keys.length, 'keys'),\n      Layout.pubKey('recentPackagehash'),\n    ]);\n\n    const transaction = {\n      numRequiredSignatures: Buffer.from([this.signatures.length]),\n      numCreditOnlySignedAccounts: Buffer.from([numCreditOnlySignedAccounts]),\n      numCreditOnlyUnsignedAccounts: Buffer.from([\n        numCreditOnlyUnsignedAccounts,\n      ]),\n      keyCount: Buffer.from(keyCount),\n      keys: keys.map(key => new PubKey(key).toBuffer()),\n      recentPackagehash: Buffer.from(bs58.decode(recentPackagehash)),\n    };\n\n    let signData = Buffer.alloc(2048);\n    const length = signDataLayout.encode(transaction, signData);\n    instructionBuffer.copy(signData, length);\n    signData = signData.slice(0, length + instructionBuffer.length);\n\n    return signData;\n  }\n\n  /**\n   * Sign the Transaction with the specified accounts.  Multiple signatures may\n   * be applied to a Transaction. The first signature is considered \"primary\"\n   * and is used when testing for Transaction confirmation.\n   *\n   * Transaction fields should not be modified after the first call to `sign`,\n   * as doing so may invalidate the signature and cause the Transaction to be\n   * rejected.\n   *\n   * The Transaction must be assigned a valid `recentPackagehash` before invoking this method\n   */\n  sign(...signers: Array<BusAccount>) {\n    this.signPartial(...signers);\n  }\n\n  /**\n   * Partially sign a Transaction with the specified accounts.  The `BusAccount`\n   * inputs will be used to sign the Transaction immediately, while any\n   * `PubKey` inputs will be referenced in the signed Transaction but need to\n   * be filled in later by calling `addSigner()` with the matching `BusAccount`.\n   *\n   * All the caveats from the `sign` method apply to `signPartial`\n   */\n  signPartial(...partialSigners: Array<PubKey | BusAccount>) {\n    if (partialSigners.length === 0) {\n      throw new Error('No signers');\n    }\n    const signatures: Array<SignaturePubkeyPair> = partialSigners.map(\n      accountOrPublicKey => {\n        const pubKey =\n          accountOrPublicKey instanceof BusAccount\n            ? accountOrPublicKey.pubKey\n            : accountOrPublicKey;\n        return {\n          signature: null,\n          pubKey,\n        };\n      },\n    );\n    this.signatures = signatures;\n    const signData = this._fetchSignData();\n\n    partialSigners.forEach((accountOrPublicKey, index) => {\n      if (accountOrPublicKey instanceof PubKey) {\n        return;\n      }\n      const signature = nacl.sign.detached(\n        signData,\n        accountOrPublicKey.privateKey,\n      );\n      invariant(signature.length === 64);\n      signatures[index].signature = Buffer.from(signature);\n    });\n  }\n\n  /**\n   * Fill in a signature for a partially signed Transaction.  The `signer` must\n   * be the corresponding `BusAccount` for a `PubKey` that was previously provided to\n   * `signPartial`\n   */\n  addSigner(signer: BusAccount) {\n    const index = this.signatures.findIndex(sigpair =>\n      signer.pubKey.equals(sigpair.pubKey),\n    );\n    if (index < 0) {\n      throw new Error(`Unknown signer: ${signer.pubKey.toString()}`);\n    }\n\n    const signData = this._fetchSignData();\n    const signature = nacl.sign.detached(signData, signer.privateKey);\n    invariant(signature.length === 64);\n    this.signatures[index].signature = Buffer.from(signature);\n  }\n\n  /**\n   * Serialize the Transaction in the wire format.\n   *\n   * The Transaction must have a valid `signature` before invoking this method\n   */\n  serialize(): Buffer {\n    const {signatures} = this;\n    if (!signatures) {\n      throw new Error('Transaction has not been signed');\n    }\n\n    const signData = this._fetchSignData();\n    const signatureCount = [];\n    shortvec.encodeLength(signatureCount, signatures.length);\n    const transactionLength =\n      signatureCount.length + signatures.length * 64 + signData.length;\n    const wireTransaction = Buffer.alloc(transactionLength);\n    invariant(signatures.length < 256);\n    Buffer.from(signatureCount).copy(wireTransaction, 0);\n    signatures.forEach(({signature}, index) => {\n      invariant(signature !== null, `null signature`);\n      invariant(signature.length === 64, `signature has invalid length`);\n      Buffer.from(signature).copy(\n        wireTransaction,\n        signatureCount.length + index * 64,\n      );\n    });\n    signData.copy(\n      wireTransaction,\n      signatureCount.length + signatures.length * 64,\n    );\n    invariant(\n      wireTransaction.length <= PACKET_DATA_SIZE,\n      `Transaction too large: ${wireTransaction.length} > ${PACKET_DATA_SIZE}`,\n    );\n    return wireTransaction;\n  }\n\n  /**\n   * Deprecated method\n   * @private\n   */\n  get keys(): Array<PubKey> {\n    invariant(this.operations.length === 1);\n    return this.operations[0].keys.map(keyObj => keyObj.pubkey);\n  }\n\n  /**\n   * Deprecated method\n   * @private\n   */\n  get controllerId(): PubKey {\n    invariant(this.operations.length === 1);\n    return this.operations[0].controllerId;\n  }\n\n  /**\n   * Deprecated method\n   * @private\n   */\n  get data(): Buffer {\n    invariant(this.operations.length === 1);\n    return this.operations[0].data;\n  }\n\n  /**\n   * Parse a wire transaction into a Transaction object.\n   */\n  static from(buffer: Buffer): Transaction {\n    const PUBKEY_LENGTH = 32;\n    const SIGNATURE_LENGTH = 64;\n\n    function isCreditDebit(\n      i: number,\n      numRequiredSignatures: number,\n      numCreditOnlySignedAccounts: number,\n      numCreditOnlyUnsignedAccounts: number,\n      numKeys: number,\n    ): boolean {\n      return (\n        i < numRequiredSignatures - numCreditOnlySignedAccounts ||\n        (i >= numRequiredSignatures &&\n          i < numKeys - numCreditOnlyUnsignedAccounts)\n      );\n    }\n\n    let transaction = new Transaction();\n\n    // Slice up wire data\n    let byteArray = [...buffer];\n\n    const signatureCount = shortvec.decodeLength(byteArray);\n    let signatures = [];\n    for (let i = 0; i < signatureCount; i++) {\n      const signature = byteArray.slice(0, SIGNATURE_LENGTH);\n      byteArray = byteArray.slice(SIGNATURE_LENGTH);\n      signatures.push(signature);\n    }\n\n    const numRequiredSignatures = byteArray.shift();\n    // byteArray = byteArray.slice(1); // Skip numRequiredSignatures byte\n    const numCreditOnlySignedAccounts = byteArray.shift();\n    // byteArray = byteArray.slice(1); // Skip numCreditOnlySignedAccounts byte\n    const numCreditOnlyUnsignedAccounts = byteArray.shift();\n    // byteArray = byteArray.slice(1); // Skip numCreditOnlyUnsignedAccounts byte\n\n    const accountCount = shortvec.decodeLength(byteArray);\n    let accounts = [];\n    for (let i = 0; i < accountCount; i++) {\n      const account = byteArray.slice(0, PUBKEY_LENGTH);\n      byteArray = byteArray.slice(PUBKEY_LENGTH);\n      accounts.push(account);\n    }\n\n    const recentPackagehash = byteArray.slice(0, PUBKEY_LENGTH);\n    byteArray = byteArray.slice(PUBKEY_LENGTH);\n\n    const instructionCount = shortvec.decodeLength(byteArray);\n    let operations = [];\n    for (let i = 0; i < instructionCount; i++) {\n      let instruction = {};\n      instruction.programIndex = byteArray.shift();\n      const accountIndexCount = shortvec.decodeLength(byteArray);\n      instruction.accountIndex = byteArray.slice(0, accountIndexCount);\n      byteArray = byteArray.slice(accountIndexCount);\n      const dataLength = shortvec.decodeLength(byteArray);\n      instruction.data = byteArray.slice(0, dataLength);\n      byteArray = byteArray.slice(dataLength);\n      operations.push(instruction);\n    }\n\n    // Populate Transaction object\n    transaction.recentPackagehash = new PubKey(recentPackagehash).toBase58();\n    for (let i = 0; i < signatureCount; i++) {\n      const sigPubkeyPair = {\n        signature: Buffer.from(signatures[i]),\n        pubKey: new PubKey(accounts[i]),\n      };\n      transaction.signatures.push(sigPubkeyPair);\n    }\n    for (let i = 0; i < instructionCount; i++) {\n      let instructionData = {\n        keys: [],\n        controllerId: new PubKey(accounts[operations[i].programIndex]),\n        data: Buffer.from(operations[i].data),\n      };\n      for (let j = 0; j < operations[i].accountIndex.length; j++) {\n        const pubkey = new PubKey(accounts[operations[i].accountIndex[j]]);\n\n        instructionData.keys.push({\n          pubkey,\n          isSigner: transaction.signatures.some(\n            keyObj => keyObj.pubKey.toString() === pubkey.toString(),\n          ),\n          isDebitable: isCreditDebit(\n            j,\n            numRequiredSignatures,\n            numCreditOnlySignedAccounts,\n            numCreditOnlyUnsignedAccounts,\n            accounts.length,\n          ),\n        });\n      }\n      let instruction = new TxOperation(instructionData);\n      transaction.operations.push(instruction);\n    }\n    return transaction;\n  }\n}\n","// @flow\n\n// zzz\nexport function sleep(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n","// @flow\n\nimport assert from 'assert';\nimport {parse as urlParse, format as urlFormat} from 'url';\nimport fetch from 'node-fetch';\nimport jayson from 'jayson/lib/client/browser';\nimport {struct} from 'superstruct';\nimport {Client as RpcWebSocketClient} from 'rpc-websockets';\n\nimport {DEFAULT_TICKS_PER_SLOT, NUM_TICKS_PER_SEC} from './timing';\nimport {PubKey} from './pubkey';\nimport {Transaction} from './transaction-controller';\nimport {sleep} from './util/sleep';\nimport type {Blockhash} from './bus-blockhash';\nimport type {FeeCalculator} from './fee-calculator';\nimport type {BusAccount} from './bus-account';\nimport type {TxnSignature} from './transaction-controller';\n\ntype RpcReq = (methodName: string, args: Array<any>) => any;\n\n/**\n * Information describing a cluster node\n *\n * @typedef {Object} NodeInfo\n * @property {string} pubkey Identity public key of the node\n * @property {string} gossip Gossip network address for the node\n * @property {string} tpu TPU network address for the node (null if not available)\n * @property {string|null} rpc JSON RPC network address for the node (null if not available)\n */\ntype NodeInfo = {\n  pubkey: string,\n  gossip: string,\n  tpu: string | null,\n  rpc: string | null,\n};\n\n/**\n * Information describing a vote account\n *\n * @typedef {Object} VoteAccountInfo\n * @property {string} votePubkey Public key of the vote account\n * @property {string} nodePubkey Identity public key of the node voting with this account\n * @property {string} stake The stake, in difs, delegated to this vote account\n * @property {string} commission A 32-bit integer used as a fraction (commission/0xFFFFFFFF) for rewards payout\n */\ntype VoteAccountInfo = {\n  votePubkey: string,\n  nodePubkey: string,\n  stake: number,\n  commission: number,\n};\n\nfunction createRpcReq(url): RpcReq {\n  const server = jayson(async (request, callback) => {\n    const options = {\n      method: 'POST',\n      body: request,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    try {\n      const res = await fetch(url, options);\n      const text = await res.text();\n      callback(null, text);\n    } catch (err) {\n      callback(err);\n    }\n  });\n\n  return (method, args) => {\n    return new Promise((resolve, reject) => {\n      server.request(method, args, (err, response) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n        resolve(response);\n      });\n    });\n  };\n}\n\n/**\n * Expected JSON RPC response for the \"fetchAccountBalance\" message\n */\nconst FetchBalanceRpcResult = struct({\n  jsonrpc: struct.literal('2.0'),\n  id: 'string',\n  error: 'any?',\n  result: 'number?',\n});\n\nconst FetchReputationRpcResult = struct({\n  jsonrpc: struct.literal('2.0'),\n  id: 'string',\n  error: 'any?',\n  result: 'number?',\n});\n\n\n/**\n * @private\n */\nfunction jsonRpcResult(resultDescription: any) {\n  const jsonRpcVersion = struct.literal('2.0');\n  return struct.union([\n    struct({\n      jsonrpc: jsonRpcVersion,\n      id: 'string',\n      error: 'any',\n    }),\n    struct({\n      jsonrpc: jsonRpcVersion,\n      id: 'string',\n      error: 'null?',\n      result: resultDescription,\n    }),\n  ]);\n}\n\n/**\n * @private\n */\nconst AccountDetailResult = struct({\n  executable: 'boolean',\n  owner: 'array',\n  difs: 'number',\n  reputations: 'number',\n  data: 'array',\n});\n\n/**\n * Expected JSON RPC response for the \"fetchAccountDetail\" message\n */\nconst fetchAccountDetailRpcResult = jsonRpcResult(AccountDetailResult);\n\n/***\n * Expected JSON RPC response for the \"accountNotification\" message\n */\nconst AccountNoticeResult = struct({\n  subscription: 'number',\n  result: AccountDetailResult,\n});\n\n/**\n * @private\n */\nconst ControllerAccountDetailResult = struct(['string', AccountDetailResult]);\n\n/***\n * Expected JSON RPC response for the \"controllerNotification\" message\n */\nconst ControllerAccountNoticeResult = struct({\n  subscription: 'number',\n  result: ControllerAccountDetailResult,\n});\n\n/**\n * Expected JSON RPC response for the \"confmTxn\" message\n */\nconst ConfmTxnRpcResult = jsonRpcResult('boolean');\n\n/**\n * Expected JSON RPC response for the \"fetchRoundLeader\" message\n */\nconst FetchRoundLeader = jsonRpcResult('string');\n\n/**\n * Expected JSON RPC response for the \"fetchClusterNodes\" message\n */\nconst GetClusterNodes = jsonRpcResult(\n  struct.list([\n    struct({\n      pubkey: 'string',\n      gossip: 'string',\n      tpu: struct.union(['null', 'string']),\n      rpc: struct.union(['null', 'string']),\n    }),\n  ]),\n);\n/**\n * @ignore\n */\nconst GetClusterNodes_015 = jsonRpcResult(\n  struct.list([\n    struct({\n      id: 'string',\n      gossip: 'string',\n      tpu: struct.union(['null', 'string']),\n      rpc: struct.union(['null', 'string']),\n    }),\n  ]),\n);\n\n/**\n * Expected JSON RPC response for the \"getEpochVoteAccounts\" message\n */\nconst GetEpochVoteAccounts = jsonRpcResult(\n  struct.list([\n    struct({\n      votePubkey: 'string',\n      nodePubkey: 'string',\n      stake: 'number',\n      commission: 'number',\n    }),\n  ]),\n);\n\n/**\n * Expected JSON RPC response for the \"fetchSignatureState\" message\n */\nconst FetchSignatureStateRpcResult = jsonRpcResult(\n  struct.union([\n    'null',\n    struct.union([struct({Ok: 'null'}), struct({Err: 'object'})]),\n  ]),\n);\n\n/**\n * Expected JSON RPC response for the \"fetchTxnAmount\" message\n */\nconst FetchTxnAmountRpcResult = jsonRpcResult('number');\n\n/**\n * Expected JSON RPC response for the \"getTotalSupply\" message\n */\nconst GetTotalSupplyRpcResult = jsonRpcResult('number');\n\n/**\n * Expected JSON RPC response for the \"fetchRecentBlockhash\" message\n */\nconst FetchRecentBlockhash = jsonRpcResult([\n  'string',\n  struct({\n    difsPerSignature: 'number',\n    maxDifsPerSignature: 'number',\n    minDifsPerSignature: 'number',\n    targetDifsPerSignature: 'number',\n    targetSignaturesPerSlot: 'number',\n  }),\n]);\n/**\n * @ignore\n */\nconst GetRecentBlockhash_015 = jsonRpcResult([\n  'string',\n  struct({\n    difsPerSignature: 'number',\n  }),\n]);\n\n/**\n * Expected JSON RPC response for the \"reqDrone\" message\n */\nconst ReqDroneRpcResult = jsonRpcResult('string');\n\n/**\n * Expected JSON RPC response for the \"reqReputation\" message\n */\nconst ReqReputationRpcResult = jsonRpcResult('string');\n\n/**\n * Expected JSON RPC response for the \"sendTxn\" message\n */\nconst SendTxnRpcResult = jsonRpcResult('string');\n\n/**\n * Information describing an account\n *\n * @typedef {Object} AccountDetail\n * @property {number} difs Number of difs assigned to the account\n * @property {PubKey} owner Identifier of the controller that owns the account\n * @property {?Buffer} data Optional data assigned to the account\n * @property {boolean} executable `true` if this account's data contains a loaded controller\n */\ntype AccountDetail = {\n  executable: boolean,\n  owner: PubKey,\n  difs: number,\n  reputations: number,\n  data: Buffer,\n};\n\n/**\n * BusAccount information identified by pubkey\n *\n * @typedef {Object} KeyedAccountDetail\n * @property {PubKey} accountId\n * @property {AccountDetail} fetchAccountDetail\n */\ntype KeyedAccountDetail = {\n  accountId: PubKey,\n  fetchAccountDetail: AccountDetail,\n};\n\n/**\n * Callback function for account change notifications\n */\nexport type AccountChangeCallback = (fetchAccountDetail: AccountDetail) => void;\n\n/**\n * @private\n */\ntype AccountSubscriptionDetail = {\n  pubKey: string, // PubKey of the account as a base 58 string\n  callback: AccountChangeCallback,\n  subscriptionId: null | number, // null when there's no current server subscription id\n};\n\n/**\n * Callback function for controller account change notifications\n */\nexport type ControllerAccountChangeCallback = (\n  keyedAccountInfo: KeyedAccountDetail,\n) => void;\n\n/**\n * @private\n */\ntype ControllerAccountSubscriptionDetail = {\n  controllerId: string, // PubKey of the controller as a base 58 string\n  callback: ControllerAccountChangeCallback,\n  subscriptionId: null | number, // null when there's no current server subscription id\n};\n\n/**\n * Signature status: Success\n *\n * @typedef {Object} SignaturePass\n */\nexport type SignaturePass = {|\n  Ok: null,\n|};\n\n/**\n * Signature status: TxnErr\n *\n * @typedef {Object} TxnErr\n */\nexport type TxnErr = {|\n  Err: Object,\n|};\n\n/**\n * @ignore\n */\ntype BlockhashAndFeeCalculator = [Blockhash, FeeCalculator]; // This type exists to workaround an esdoc parse error\n\n/**\n * A connection to a fullnode JSON RPC endpoint\n */\nexport class Connection {\n  _rpcReq: RpcReq;\n  _rpcWebSock: RpcWebSocketClient;\n  _rpcWebSockConnected: boolean = false;\n\n  _blockhashInfo: {\n    recentPackagehash: Blockhash | null,\n    seconds: number,\n    transactionSignatures: Array<string>,\n  };\n  _disableBlockhashCaching: boolean = false;\n  _accountChangeSubscriptions: {[number]: AccountSubscriptionDetail} = {};\n  _accountChangeSubscriptionCounter: number = 0;\n  _controllerAccountChangeSubscriptions: {\n    [number]: ControllerAccountSubscriptionDetail,\n  } = {};\n  _controllerAccountChangeSubscriptionCounter: number = 0;\n\n  /**\n   * Establish a JSON RPC connection\n   *\n   * @param endpoint URL to the fullnode JSON RPC endpoint\n   */\n  constructor(endpoint: string) {\n    let url = urlParse(endpoint);\n\n    this._rpcReq = createRpcReq(url.href);\n    this._blockhashInfo = {\n      recentPackagehash: null,\n      seconds: -1,\n      transactionSignatures: [],\n    };\n\n    url.protocol = url.protocol === 'https:' ? 'wss:' : 'ws:';\n    url.host = '';\n    url.port = String(Number(url.port) + 1);\n    if (url.port === '1') {\n      url.port = url.protocol === 'wss:' ? '8901' : '8900';\n    }\n    this._rpcWebSock = new RpcWebSocketClient(urlFormat(url), {\n      autoconnect: false,\n      max_reconnects: Infinity,\n    });\n    this._rpcWebSock.on('open', this._wsOnOpen.bind(this));\n    this._rpcWebSock.on('error', this._wsOnErr.bind(this));\n    this._rpcWebSock.on('close', this._wsOnClose.bind(this));\n    this._rpcWebSock.on(\n      'accountNotification',\n      this._wsOnAccountNotice.bind(this),\n    );\n    this._rpcWebSock.on(\n      'controllerNotification',\n      this._wsOnProgramAccountNotification.bind(this),\n    );\n  }\n\n  /**\n   * Fetch the balance for the specified public key\n   */\n  async fetchAccountBalance(pubKey: PubKey): Promise<number> {\n    const unsafeRes = await this._rpcReq('getDif', [\n      pubKey.toBase58(),\n    ]);\n    const res = FetchBalanceRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  async fetchAccountReputation(pubKey: PubKey): Promise<number> {\n    const unsafeRes = await this._rpcReq('getReputation', [\n      pubKey.toBase58(),\n    ]);\n    const res = FetchReputationRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Fetch all the account info for the specified public key\n   */\n  async fetchAccountDetail(pubKey: PubKey): Promise<AccountDetail> {\n    const unsafeRes = await this._rpcReq('getAccountInfo', [\n      pubKey.toBase58(),\n    ]);\n    const res = fetchAccountDetailRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n\n    const {result} = res;\n    assert(typeof result !== 'undefined');\n\n    return {\n      executable: result.executable,\n      owner: new PubKey(result.owner),\n      difs: result.difs,\n      reputations: result.reputations,\n      data: Buffer.from(result.data),\n    };\n  }\n\n  /**\n   * Confirm the transaction identified by the specified signature\n   */\n  async confmTxn(signature: TxnSignature): Promise<boolean> {\n    const unsafeRes = await this._rpcReq('confirmTxn', [signature]);\n    const res = ConfmTxnRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Return the list of nodes that are currently participating in the cluster\n   */\n  async fetchClusterNodes(): Promise<Array<NodeInfo>> {\n    const unsafeRes = await this._rpcReq('getClusterNodes', []);\n\n    // Legacy v0.15 response.  TODO: Remove in August 2019\n    try {\n      const res_015 = GetClusterNodes_015(unsafeRes);\n      if (res_015.error) {\n        console.log('no', res_015.error);\n        throw new Error(res_015.error.message);\n      }\n      return res_015.result.map(node => {\n        node.pubkey = node.id;\n        node.id = undefined;\n        return node;\n      });\n    } catch (e) {\n      // Not legacy format\n    }\n    // End Legacy v0.15 response\n\n    const res = GetClusterNodes(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Return the list of nodes that are currently participating in the cluster\n   */\n  async getEpochVoteAccounts(): Promise<Array<VoteAccountInfo>> {\n    const unsafeRes = await this._rpcReq('getEpochVoteAccounts', []);\n    const res = GetEpochVoteAccounts(unsafeRes);\n    //const res = unsafeRes;\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Fetch the current slot leader of the cluster\n   */\n  async fetchRoundLeader(): Promise<string> {\n    const unsafeRes = await this._rpcReq('getRoundLeader', []);\n    const res = FetchRoundLeader(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Fetch the current transaction count of the cluster\n   */\n  async fetchSignatureState(\n    signature: TxnSignature,\n  ): Promise<SignaturePass | TxnErr | null> {\n    const unsafeRes = await this._rpcReq('getSignatureState', [signature]);\n    const res = FetchSignatureStateRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Fetch the current transaction count of the cluster\n   */\n  async fetchTxnAmount(): Promise<number> {\n    const unsafeRes = await this._rpcReq('getTxnCnt', []);\n    const res = FetchTxnAmountRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return Number(res.result);\n  }\n\n  /**\n   * Fetch the current total currency supply of the cluster\n   */\n  async getTotalSupply(): Promise<number> {\n    const unsafeRes = await this._rpcReq('getTotalSupply', []);\n    const res = GetTotalSupplyRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return Number(res.result);\n  }\n\n  /**\n   * Fetch a recent blockhash from the cluster\n   */\n  async fetchRecentBlockhash(): Promise<BlockhashAndFeeCalculator> {\n    const unsafeRes = await this._rpcReq('getLatestBlockhash', []);\n\n    // Legacy v0.15 response.  TODO: Remove in August 2019\n    try {\n      const res_015 = GetRecentBlockhash_015(unsafeRes);\n      if (res_015.error) {\n        throw new Error(res_015.error.message);\n      }\n      const [blockhash, feeCalculator] = res_015.result;\n      feeCalculator.targetSignaturesPerSlot = 42;\n      feeCalculator.targetDifsPerSignature =\n        feeCalculator.difsPerSignature;\n\n      return [blockhash, feeCalculator];\n    } catch (e) {\n      // Not legacy format\n    }\n    // End Legacy v0.15 response\n\n    const res = FetchRecentBlockhash(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Request an allocation of difs to the specified account\n   */\n  async reqDrone(\n    to: PubKey,\n    amount: number,\n  ): Promise<TxnSignature> {\n    const unsafeRes = await this._rpcReq('requestDif', [\n      to.toBase58(),\n      amount,\n    ]);\n    const res = ReqDroneRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n    /**\n   * Request an allocation of reputations to the specified account\n   */\n  async reqReputation(\n    to: PubKey,\n    amount: number,\n  ): Promise<TxnSignature> {\n    const unsafeRes = await this._rpcReq('requestReputation', [\n      to.toBase58(),\n      amount,\n    ]);\n    const res = ReqReputationRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Sign and send a transaction\n   */\n  async sendTxn(\n    transaction: Transaction,\n    ...signers: Array<BusAccount>\n  ): Promise<TxnSignature> {\n    for (;;) {\n      // Attempt to use a recent blockhash for up to 30 seconds\n      const seconds = new Date().getSeconds();\n      if (\n        this._blockhashInfo.recentPackagehash != null &&\n        this._blockhashInfo.seconds < seconds + 30\n      ) {\n        transaction.recentPackagehash = this._blockhashInfo.recentPackagehash;\n        transaction.sign(...signers);\n        if (!transaction.signature) {\n          throw new Error('!signature'); // should never happen\n        }\n\n        // If the signature of this transaction has not been seen before with the\n        // current recentPackagehash, all done.\n        const signature = transaction.signature.toString();\n        if (!this._blockhashInfo.transactionSignatures.includes(signature)) {\n          this._blockhashInfo.transactionSignatures.push(signature);\n          if (this._disableBlockhashCaching) {\n            this._blockhashInfo.seconds = -1;\n          }\n          break;\n        }\n      }\n\n      // Fetch a new blockhash\n      let attempts = 0;\n      const startTime = Date.now();\n      for (;;) {\n        const [\n          recentPackagehash,\n          //feeCalculator,\n        ] = await this.fetchRecentBlockhash();\n\n        if (this._blockhashInfo.recentPackagehash != recentPackagehash) {\n          this._blockhashInfo = {\n            recentPackagehash,\n            seconds: new Date().getSeconds(),\n            transactionSignatures: [],\n          };\n          break;\n        }\n        if (attempts === 50) {\n          throw new Error(\n            `Unable to obtain a new blockhash after ${Date.now() -\n              startTime}ms`,\n          );\n        }\n\n        // Sleep for approximately half a slot\n        await sleep((500 * DEFAULT_TICKS_PER_SLOT) / NUM_TICKS_PER_SEC);\n\n        ++attempts;\n      }\n    }\n\n    const wireTransaction = transaction.serialize();\n    return await this.sendNativeTxn(wireTransaction);\n  }\n\n  /**\n   * @private\n   */\n  async fullnodeExit(): Promise<boolean> {\n    const unsafeRes = await this._rpcReq('fullnodeQuit', []);\n    const res = jsonRpcResult('boolean')(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    return res.result;\n  }\n\n  /**\n   * Send a transaction that has already been signed and serialized into the\n   * wire format\n   */\n  async sendNativeTxn(\n    rawTransaction: Buffer,\n  ): Promise<TxnSignature> {\n    const unsafeRes = await this._rpcReq('sendTxn', [\n      [...rawTransaction],\n    ]);\n    const res = SendTxnRpcResult(unsafeRes);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n    assert(typeof res.result !== 'undefined');\n    assert(res.result);\n    return res.result;\n  }\n\n  /**\n   * @private\n   */\n  _wsOnOpen() {\n    this._rpcWebSockConnected = true;\n    this._updateSubscriptions();\n  }\n\n  /**\n   * @private\n   */\n  _wsOnErr(err: Error) {\n    console.log('ws error:', err.message);\n  }\n\n  /**\n   * @private\n   */\n  _wsOnClose(code: number, message: string) {\n    // 1000 means _rpcWebSock.close() was called explicitly\n    if (code !== 1000) {\n      console.log('ws close:', code, message);\n    }\n    this._rpcWebSockConnected = false;\n  }\n\n  /**\n   * @private\n   */\n  async _updateSubscriptions() {\n    const accountKeys = Object.keys(this._accountChangeSubscriptions).map(\n      Number,\n    );\n    const programKeys = Object.keys(\n      this._controllerAccountChangeSubscriptions,\n    ).map(Number);\n    if (accountKeys.length === 0 && programKeys.length === 0) {\n      this._rpcWebSock.close();\n      return;\n    }\n\n    if (!this._rpcWebSockConnected) {\n      for (let id of accountKeys) {\n        this._accountChangeSubscriptions[id].subscriptionId = null;\n      }\n      for (let id of programKeys) {\n        this._controllerAccountChangeSubscriptions[id].subscriptionId = null;\n      }\n      this._rpcWebSock.connect();\n      return;\n    }\n\n    for (let id of accountKeys) {\n      const {subscriptionId, pubKey} = this._accountChangeSubscriptions[id];\n      if (subscriptionId === null) {\n        try {\n          this._accountChangeSubscriptions[\n            id\n          ].subscriptionId = await this._rpcWebSock.call('accountSubscribe', [\n            pubKey,\n          ]);\n        } catch (err) {\n          console.log(\n            `accountSubscribe error for ${pubKey}: ${err.message}`,\n          );\n        }\n      }\n    }\n    for (let id of programKeys) {\n      const {\n        subscriptionId,\n        controllerId,\n      } = this._controllerAccountChangeSubscriptions[id];\n      if (subscriptionId === null) {\n        try {\n          this._controllerAccountChangeSubscriptions[\n            id\n          ].subscriptionId = await this._rpcWebSock.call('programSubscribe', [\n            controllerId,\n          ]);\n        } catch (err) {\n          console.log(\n            `programSubscribe error for ${controllerId}: ${err.message}`,\n          );\n        }\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _wsOnAccountNotice(notification: Object) {\n    const res = AccountNoticeResult(notification);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n\n    const keys = Object.keys(this._accountChangeSubscriptions).map(Number);\n    for (let id of keys) {\n      const sub = this._accountChangeSubscriptions[id];\n      if (sub.subscriptionId === res.subscription) {\n        const {result} = res;\n        assert(typeof result !== 'undefined');\n\n        sub.callback({\n          executable: result.executable,\n          owner: new PubKey(result.owner),\n          difs: result.difs,\n          reputations: result.reputations,\n          data: Buffer.from(result.data),\n        });\n        return true;\n      }\n    }\n  }\n\n  /**\n   * Register a callback to be invoked whenever the specified account changes\n   *\n   * @param publickey Public key of the account to monitor\n   * @param callback Function to invoke whenever the account is changed\n   * @return subscription id\n   */\n  onAccountChange(\n    pubKey: PubKey,\n    callback: AccountChangeCallback,\n  ): number {\n    const id = ++this._accountChangeSubscriptionCounter;\n    this._accountChangeSubscriptions[id] = {\n      pubKey: pubKey.toBase58(),\n      callback,\n      subscriptionId: null,\n    };\n    this._updateSubscriptions();\n    return id;\n  }\n\n  /**\n   * Deregister an account notification callback\n   *\n   * @param id subscription id to deregister\n   */\n  async removeListenerOfAccountChange(id: number): Promise<void> {\n    if (this._accountChangeSubscriptions[id]) {\n      const {subscriptionId} = this._accountChangeSubscriptions[id];\n      delete this._accountChangeSubscriptions[id];\n      if (subscriptionId !== null) {\n        try {\n          await this._rpcWebSock.call('accountUnsubscribe', [subscriptionId]);\n        } catch (err) {\n          console.log('accountUnsubscribe error:', err.message);\n        }\n      }\n      this._updateSubscriptions();\n    } else {\n      throw new Error(`Unknown account change id: ${id}`);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _wsOnProgramAccountNotification(notification: Object) {\n    const res = ControllerAccountNoticeResult(notification);\n    if (res.error) {\n      throw new Error(res.error.message);\n    }\n\n    const keys = Object.keys(this._controllerAccountChangeSubscriptions).map(\n      Number,\n    );\n    for (let id of keys) {\n      const sub = this._controllerAccountChangeSubscriptions[id];\n      if (sub.subscriptionId === res.subscription) {\n        const {result} = res;\n        assert(typeof result !== 'undefined');\n\n        sub.callback({\n          accountId: result[0],\n          fetchAccountDetail: {\n            executable: result[1].executable,\n            owner: new PubKey(result[1].owner),\n            difs: result[1].difs,\n            reputations: result[1].reputations,\n            data: Buffer.from(result[1].data),\n          },\n        });\n        return true;\n      }\n    }\n  }\n\n  /**\n   * Register a callback to be invoked whenever accounts owned by the\n   * specified controller change\n   *\n   * @param controllerId Public key of the controller to monitor\n   * @param callback Function to invoke whenever the account is changed\n   * @return subscription id\n   */\n  onControllerAccountChange(\n    controllerId: PubKey,\n    callback: ControllerAccountChangeCallback,\n  ): number {\n    const id = ++this._controllerAccountChangeSubscriptionCounter;\n    this._controllerAccountChangeSubscriptions[id] = {\n      controllerId: controllerId.toBase58(),\n      callback,\n      subscriptionId: null,\n    };\n    this._updateSubscriptions();\n    return id;\n  }\n\n  /**\n   * Deregister an account notification callback\n   *\n   * @param id subscription id to deregister\n   */\n  async removeControllerAccountChangeListener(id: number): Promise<void> {\n    if (this._controllerAccountChangeSubscriptions[id]) {\n      const {subscriptionId} = this._controllerAccountChangeSubscriptions[id];\n      delete this._controllerAccountChangeSubscriptions[id];\n      if (subscriptionId !== null) {\n        try {\n          await this._rpcWebSock.call('programUnsubscribe', [subscriptionId]);\n        } catch (err) {\n          console.log('programUnsubscribe error:', err.message);\n        }\n      }\n      this._updateSubscriptions();\n    } else {\n      throw new Error(`Unknown account change id: ${id}`);\n    }\n  }\n}\n","// @flow\n\nimport invariant from 'assert';\n\nimport {Connection} from '../connection';\nimport {Transaction} from '../transaction-controller';\nimport {sleep} from './sleep';\nimport type {BusAccount} from '../bus-account';\nimport type {TxnSignature} from '../transaction-controller';\nimport {DEFAULT_TICKS_PER_SLOT, NUM_TICKS_PER_SEC} from '../timing';\n\n/**\n * Sign, send and confirm a transaction\n */\nexport async function sendAndconfmTx(\n  connection: Connection,\n  transaction: Transaction,\n  ...signers: Array<BusAccount>\n): Promise<TxnSignature> {\n  let sendRetries = 10;\n  let signature;\n  for (;;) {\n    const start = Date.now();\n    signature = await connection.sendTxn(transaction, ...signers);\n\n    // Wait up to a couple slots for a confirmation\n    let status = null;\n    let statusRetries = 6;\n    for (;;) {\n      status = await connection.fetchSignatureState(signature);\n      if (status) {\n        break;\n      }\n\n      if (--statusRetries <= 0) {\n        break;\n      }\n      // Sleep for approximately half a slot\n      await sleep((500 * DEFAULT_TICKS_PER_SLOT) / NUM_TICKS_PER_SEC);\n    }\n\n    if (status && 'Ok' in status) {\n      break;\n    }\n    if (--sendRetries <= 0) {\n      const duration = (Date.now() - start) / 1000;\n      throw new Error(\n        `Transaction '${signature}' was not confirmed in ${duration.toFixed(\n          2,\n        )} seconds (${JSON.stringify(status)})`,\n      );\n    }\n\n    if (status && status.Err && !('AccountInUse' in status.Err)) {\n      throw new Error(\n        `Transaction ${signature} failed (${JSON.stringify(status)})`,\n      );\n    }\n\n    // Retry in 0..100ms to try to avoid another AccountInUse collision\n    await sleep(Math.random() * 100);\n  }\n\n  invariant(signature !== undefined);\n  return signature;\n}\n","// @flow\n\nimport * as BufferLayout from 'buffer-layout';\n\nimport {Transaction} from './transaction-controller';\nimport {PubKey} from './pubkey';\nimport * as Layout from './resize';\n\n/**\n * Factory class for transactions to interact with the System controller\n */\nexport class SystemController {\n  /**\n   * Public key that identifies the System controller\n   */\n  static get controllerId(): PubKey {\n    return new PubKey(\n      '0x000000000000000000000000000000000000000000000000000000000000000',\n    );\n  }\n\n  /**\n   * Generate a Transaction that creates a new account\n   */\n  static createNewAccount(\n    from: PubKey,\n    createNewAccount: PubKey,\n    difs: number,\n    reputations: number,\n    space: number,\n    controllerId: PubKey,\n  ): Transaction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      BufferLayout.ns64('difs'),\n      BufferLayout.ns64('reputations'),\n      BufferLayout.ns64('space'),\n      Layout.pubKey('controllerId'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 0, // Create BusAccount instruction\n        difs,\n        reputations,\n        space,\n        controllerId: controllerId.toBuffer(),\n      },\n      data,\n    );\n\n    return new Transaction().add({\n      keys: [\n        {pubkey: from, isSigner: true, isDebitable: true},\n        {pubkey: createNewAccount, isSigner: false, isDebitable: true},\n      ],\n      controllerId: SystemController.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Generate a Transaction that transfers difs from one account to another\n   */\n  static transfer(from: PubKey, to: PubKey, amount: number): Transaction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      BufferLayout.ns64('amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 2, // Move instruction\n        amount,\n      },\n      data,\n    );\n\n    return new Transaction().add({\n      keys: [\n        {pubkey: from, isSigner: true, isDebitable: true},\n        {pubkey: to, isSigner: false, isDebitable: false},\n      ],\n      controllerId: SystemController.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Generate a Transaction that transfers reputations from one account to another\n   */\n  static transferReputation(from: PubKey, to: PubKey, amount: number): Transaction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      BufferLayout.ns64('amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 4, // transfer reputations instruction\n        amount,\n      },\n      data,\n    );\n\n    return new Transaction().add({\n      keys: [\n        {pubkey: from, isSigner: true, isDebitable: true},\n        {pubkey: to, isSigner: false, isDebitable: false},\n      ],\n      controllerId: SystemController.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Generate a Transaction that assigns an account to a controller\n   */\n  static assign(from: PubKey, controllerId: PubKey): Transaction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      Layout.pubKey('controllerId'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 1, // Assign instruction\n        controllerId: controllerId.toBuffer(),\n      },\n      data,\n    );\n\n    return new Transaction().add({\n      keys: [{pubkey: from, isSigner: true, isDebitable: true}],\n      controllerId: SystemController.controllerId,\n      data,\n    });\n  }\n}\n","// @flow\n\nimport * as BufferLayout from 'buffer-layout';\n\nimport {BusAccount} from './bus-account';\nimport {PubKey} from './pubkey';\nimport {NUM_TICKS_PER_SEC} from './timing';\nimport {Transaction, PACKET_DATA_SIZE} from './transaction-controller';\nimport {sendAndconfmTx} from './util/send-and-confm-tx';\nimport {sleep} from './util/sleep';\nimport type {Connection} from './connection';\nimport {SystemController} from './system-controller';\n\n/**\n * Controller loader interface\n */\nexport class ControllerLoader {\n  /**\n   * Amount of controller data placed in each load Transaction\n   */\n  static get chunkSize(): number {\n    // Keep controller chunks under PACKET_DATA_SIZE, leaving enough room for the\n    // rest of the Transaction fields\n    //\n    // TODO: replace 300 with a proper constant for the size of the other\n    // Transaction fields\n    return PACKET_DATA_SIZE - 300;\n  }\n\n  /**\n   * Loads a generic controller\n   *\n   * @param connection The connection to use\n   * @param payer System account that pays to load the controller\n   * @param controller BusAccount to load the controller into\n   * @param controllerId Public key that identifies the loader\n   * @param data controller octets\n   */\n  static async load(\n    connection: Connection,\n    payer: BusAccount,\n    controller: BusAccount,\n    controllerId: PubKey,\n    data: Array<number>,\n  ): Promise<PubKey> {\n    {\n      const transaction = SystemController.createNewAccount(\n        payer.pubKey,\n        controller.pubKey,\n        1,\n        0,\n        data.length,\n        controllerId,\n      );\n      await sendAndconfmTx(connection, transaction, payer);\n    }\n\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      BufferLayout.u32('offset'),\n      BufferLayout.u32('bytesLength'),\n      BufferLayout.u32('bytesLengthPadding'),\n      BufferLayout.seq(\n        BufferLayout.u8('byte'),\n        BufferLayout.offset(BufferLayout.u32(), -8),\n        'bytes',\n      ),\n    ]);\n\n    const chunkSize = ControllerLoader.chunkSize;\n    let offset = 0;\n    let array = data;\n    let transactions = [];\n    while (array.length > 0) {\n      const bytes = array.slice(0, chunkSize);\n      const data = Buffer.alloc(chunkSize + 16);\n      dataLayout.encode(\n        {\n          instruction: 0, // Load instruction\n          offset,\n          bytes,\n        },\n        data,\n      );\n\n      const transaction = new Transaction().add({\n        keys: [{pubkey: controller.pubKey, isSigner: true, isDebitable: true}],\n        controllerId,\n        data,\n      });\n      transactions.push(\n        sendAndconfmTx(connection, transaction, payer, controller),\n      );\n\n      // Delay ~1 tick between write transactions in an attempt to reduce AccountInUse errors\n      // since all the write transactions modify the same controller account\n      await sleep(1000 / NUM_TICKS_PER_SEC);\n\n      // Run up to 8 Loads in parallel to prevent too many parallel transactions from\n      // getting rejected with AccountInUse.\n      //\n      // TODO: 8 was selected empirically and should probably be revisited\n      if (transactions.length === 8) {\n        await Promise.all(transactions);\n        transactions = [];\n      }\n\n      offset += chunkSize;\n      array = array.slice(chunkSize);\n    }\n    await Promise.all(transactions);\n\n    // Finalize the account loaded with controller data for execution\n    {\n      const dataLayout = BufferLayout.struct([BufferLayout.u32('instruction')]);\n\n      const data = Buffer.alloc(dataLayout.span);\n      dataLayout.encode(\n        {\n          instruction: 1, // Finalize instruction\n        },\n        data,\n      );\n\n      const transaction = new Transaction().add({\n        keys: [{pubkey: controller.pubKey, isSigner: true, isDebitable: true}],\n        controllerId,\n        data,\n      });\n      await sendAndconfmTx(connection, transaction, payer, controller);\n    }\n    return controller.pubKey;\n  }\n}\n","// @flow\n\nimport {BusAccount} from './bus-account';\nimport {PubKey} from './pubkey';\nimport {ControllerLoader} from './controller-loader';\nimport type {Connection} from './connection';\n\n/**\n * Factory class for transactions to interact with a controller loader\n */\nexport class BpfControllerLoader {\n  /**\n   * Public key that identifies the BpfControllerLoader\n   */\n  static get controllerId(): PubKey {\n    return new PubKey('BPFLoader1111111111111111111111111111111111');\n  }\n\n  /**\n   * Load a BPF controller\n   *\n   * @param connection The connection to use\n   * @param owner User account to load the controller into\n   * @param elfBytes The entire ELF containing the BPF controller\n   */\n  static load(\n    connection: Connection,\n    payer: BusAccount,\n    elf: Array<number>,\n  ): Promise<PubKey> {\n    const controller = new BusAccount();\n    return ControllerLoader.load(connection, payer, controller, BpfControllerLoader.controllerId, elf);\n  }\n}\n","// @flow\n\nimport * as BufferLayout from 'buffer-layout';\n\nimport {Transaction} from './transaction-controller';\nimport {PubKey} from './pubkey';\nimport {SystemController} from './system-controller';\n\n/**\n * Represents a condition that is met by executing a `sealWithSignature()`\n * transaction\n *\n * @typedef {Object} SignatureCond\n * @property {string} type Must equal the string 'timestamp'\n * @property {PubKey} from Public key from which `sealWithSignature()` will be accepted from\n */\nexport type SignatureCond = {\n  type: 'signature',\n  from: PubKey,\n};\n\n/**\n * Represents a condition that is met by executing a `sealWithDatetime()`\n * transaction\n *\n * @typedef {Object} TimestampCond\n * @property {string} type Must equal the string 'timestamp'\n * @property {PubKey} from Public key from which `sealWithDatetime()` will be accepted from\n * @property {Date} when The timestamp that was observed\n */\nexport type TimestampCond = {\n  type: 'timestamp',\n  from: PubKey,\n  when: Date,\n};\n\n/**\n * Represents a payment to a given public key\n *\n * @typedef {Object} Payment\n * @property {number} amount Number of difs\n * @property {PubKey} to Public key of the recipient\n */\nexport type Payment = {\n  amount: number,\n  to: PubKey,\n};\n\n/**\n * A condition that can unlock a payment\n *\n * @typedef {SignatureCond|TimestampCond} BudgetCond\n */\nexport type BudgetCond = SignatureCond | TimestampCond;\n\n/**\n * @private\n */\nfunction serializePayment(payment: Payment): Buffer {\n  const toData = payment.to.toBuffer();\n  const data = Buffer.alloc(8 + toData.length);\n  data.writeUInt32LE(payment.amount, 0);\n  toData.copy(data, 8);\n  return data;\n}\n\n/**\n * @private\n */\nfunction serializeTime(when: Date): Buffer {\n  const data = Buffer.alloc(8 + 20);\n  data.writeUInt32LE(20, 0); // size of timestamp as u64\n\n  function iso(date) {\n    function pad(number) {\n      if (number < 10) {\n        return '0' + number;\n      }\n      return number;\n    }\n\n    return (\n      date.getUTCFullYear() +\n      '-' +\n      pad(date.getUTCMonth() + 1) +\n      '-' +\n      pad(date.getUTCDate()) +\n      'T' +\n      pad(date.getUTCHours()) +\n      ':' +\n      pad(date.getUTCMinutes()) +\n      ':' +\n      pad(date.getUTCSeconds()) +\n      'Z'\n    );\n  }\n  data.write(iso(when), 8);\n  return data;\n}\n\n/**\n * @private\n */\nfunction serializeCond(condition: BudgetCond) {\n  switch (condition.type) {\n    case 'timestamp': {\n      const date = serializeTime(condition.when);\n      const from = condition.from.toBuffer();\n\n      const data = Buffer.alloc(4 + date.length + from.length);\n      data.writeUInt32LE(0, 0); // Condition enum = Timestamp\n      date.copy(data, 4);\n      from.copy(data, 4 + date.length);\n      return data;\n    }\n    case 'signature': {\n      const from = condition.from.toBuffer();\n      const data = Buffer.alloc(4 + from.length);\n      data.writeUInt32LE(1, 0); // Condition enum = Signature\n      from.copy(data, 4);\n      return data;\n    }\n    default:\n      throw new Error(`Unknown condition type: ${condition.type}`);\n  }\n}\n\n/**\n * Factory class for transactions to interact with the Budget controller\n */\nexport class BudgetController {\n  /**\n   * Public key that identifies the Budget controller\n   */\n  static get controllerId(): PubKey {\n    return new PubKey('Budget1111111111111111111111111111111111111');\n  }\n\n  /**\n   * The amount of space this controller requires\n   */\n  static get size(): number {\n    return 128;\n  }\n\n  /**\n   * Creates a timestamp condition\n   */\n  static datetimeCond(from: PubKey, when: Date): TimestampCond {\n    return {\n      type: 'timestamp',\n      from,\n      when,\n    };\n  }\n\n  /**\n   * Creates a signature condition\n   */\n  static signatureCond(from: PubKey): SignatureCond {\n    return {\n      type: 'signature',\n      from,\n    };\n  }\n\n  /**\n   * Generates a transaction that transfers difs once any of the conditions are met\n   */\n  static pay(\n    from: PubKey,\n    controller: PubKey,\n    to: PubKey,\n    amount: number,\n    ...conditions: Array<BudgetCond>\n  ): Transaction {\n    const data = Buffer.alloc(1024);\n    let pos = 0;\n    data.writeUInt32LE(0, pos); // NewBudget instruction\n    pos += 4;\n\n    switch (conditions.length) {\n      case 0: {\n        data.writeUInt32LE(0, pos); // BudgetExpr enum = Pay\n        pos += 4;\n\n        {\n          const payment = serializePayment({amount, to});\n          payment.copy(data, pos);\n          pos += payment.length;\n        }\n        const trimmedData = data.slice(0, pos);\n\n        const transaction = SystemController.createNewAccount(\n          from,\n          controller,\n          amount,\n          amount,\n          trimmedData.length,\n          this.controllerId,\n        );\n\n        return transaction.add({\n          keys: [\n            {pubkey: to, isSigner: false, isDebitable: false},\n            {pubkey: controller, isSigner: false, isDebitable: true},\n          ],\n          controllerId: this.controllerId,\n          data: trimmedData,\n        });\n      }\n      case 1: {\n        data.writeUInt32LE(1, pos); // BudgetExpr enum = After\n        pos += 4;\n        {\n          const condition = conditions[0];\n\n          const conditionData = serializeCond(condition);\n          conditionData.copy(data, pos);\n          pos += conditionData.length;\n\n          data.writeUInt32LE(0, pos); // BudgetExpr enum = Pay\n          pos += 4;\n\n          const paymentData = serializePayment({amount, to});\n          paymentData.copy(data, pos);\n          pos += paymentData.length;\n        }\n        const trimmedData = data.slice(0, pos);\n\n        const transaction = SystemController.createNewAccount(\n          from,\n          controller,\n          amount,\n          amount,\n          trimmedData.length,\n          this.controllerId,\n        );\n\n        return transaction.add({\n          keys: [{pubkey: controller, isSigner: false, isDebitable: true}],\n          controllerId: this.controllerId,\n          data: trimmedData,\n        });\n      }\n\n      case 2: {\n        data.writeUInt32LE(2, pos); // BudgetExpr enum = Or\n        pos += 4;\n\n        for (let condition of conditions) {\n          const conditionData = serializeCond(condition);\n          conditionData.copy(data, pos);\n          pos += conditionData.length;\n\n          data.writeUInt32LE(0, pos); // BudgetExpr enum = Pay\n          pos += 4;\n\n          const paymentData = serializePayment({amount, to});\n          paymentData.copy(data, pos);\n          pos += paymentData.length;\n        }\n        const trimmedData = data.slice(0, pos);\n\n        const transaction = SystemController.createNewAccount(\n          from,\n          controller,\n          amount,\n          amount,\n          trimmedData.length,\n          this.controllerId,\n        );\n\n        return transaction.add({\n          keys: [{pubkey: controller, isSigner: false, isDebitable: true}],\n          controllerId: this.controllerId,\n          data: trimmedData,\n        });\n      }\n\n      default:\n        throw new Error(\n          `A maximum of two conditions are support: ${\n            conditions.length\n          } provided`,\n        );\n    }\n  }\n\n  /**\n   * Generates a transaction that transfers difs once both conditions are met\n   */\n  static payOnAll(\n    from: PubKey,\n    controller: PubKey,\n    to: PubKey,\n    amount: number,\n    condition1: BudgetCond,\n    condition2: BudgetCond,\n  ): Transaction {\n    const data = Buffer.alloc(1024);\n    let pos = 0;\n    data.writeUInt32LE(0, pos); // NewBudget instruction\n    pos += 4;\n\n    data.writeUInt32LE(3, pos); // BudgetExpr enum = And\n    pos += 4;\n\n    for (let condition of [condition1, condition2]) {\n      const conditionData = serializeCond(condition);\n      conditionData.copy(data, pos);\n      pos += conditionData.length;\n    }\n\n    data.writeUInt32LE(0, pos); // BudgetExpr enum = Pay\n    pos += 4;\n\n    const paymentData = serializePayment({amount, to});\n    paymentData.copy(data, pos);\n    pos += paymentData.length;\n\n    const trimmedData = data.slice(0, pos);\n\n    const transaction = SystemController.createNewAccount(\n      from,\n      controller,\n      amount,\n      amount,\n      trimmedData.length,\n      this.controllerId,\n    );\n\n    return transaction.add({\n      keys: [{pubkey: controller, isSigner: false, isDebitable: true}],\n      controllerId: this.controllerId,\n      data: trimmedData,\n    });\n  }\n\n  /**\n   * Generates a transaction that applies a timestamp, which could enable a\n   * pending payment to proceed.\n   */\n  static sealWithDatetime(\n    from: PubKey,\n    controller: PubKey,\n    to: PubKey,\n    when: Date,\n  ): Transaction {\n    const whenData = serializeTime(when);\n    const data = Buffer.alloc(4 + whenData.length);\n\n    data.writeUInt32LE(1, 0); // ApplyTimestamp instruction\n    whenData.copy(data, 4);\n\n    return new Transaction().add({\n      keys: [\n        {pubkey: from, isSigner: true, isDebitable: true},\n        {pubkey: controller, isSigner: false, isDebitable: true},\n        {pubkey: to, isSigner: false, isDebitable: false},\n      ],\n      controllerId: this.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Generates a transaction that applies a signature, which could enable a\n   * pending payment to proceed.\n   */\n  static sealWithSignature(\n    from: PubKey,\n    controller: PubKey,\n    to: PubKey,\n  ): Transaction {\n    const dataLayout = BufferLayout.struct([BufferLayout.u32('instruction')]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 2, // ApplySignature instruction\n      },\n      data,\n    );\n\n    return new Transaction().add({\n      keys: [\n        {pubkey: from, isSigner: true, isDebitable: true},\n        {pubkey: controller, isSigner: false, isDebitable: true},\n        {pubkey: to, isSigner: false, isDebitable: false},\n      ],\n      controllerId: this.controllerId,\n      data,\n    });\n  }\n}\n","// @flow\n\nimport {BusAccount} from './bus-account';\nimport {PubKey} from './pubkey';\nimport {ControllerLoader} from './controller-loader';\nimport type {Connection} from './connection';\n\n/**\n * Factory class for transactions to interact with a controller loader\n */\nexport class NativeControllerLoader {\n  /**\n   * Public key that identifies the NativeControllerLoader\n   */\n  static get controllerId(): PubKey {\n    return new PubKey('NativeLoader1111111111111111111111111111111');\n  }\n\n  /**\n   * Loads a native controller\n   *\n   * @param connection The connection to use\n   * @param payer System account that pays to load the controller\n   * @param controllerName Name of the native controller\n   */\n  static load(\n    connection: Connection,\n    payer: BusAccount,\n    controllerName: string,\n  ): Promise<PubKey> {\n    const bytes = [...Buffer.from(controllerName)];\n    const controller = new BusAccount();\n    return ControllerLoader.load(\n      connection,\n      payer,\n      controller,\n      NativeControllerLoader.controllerId,\n      bytes,\n    );\n  }\n}\n","/**\n * @flow\n */\n\nimport assert from 'assert';\nimport BN from 'bn.js';\nimport * as BufferLayout from 'buffer-layout';\n\nimport * as Layout from './resize';\nimport {BusAccount} from './bus-account';\nimport {PubKey} from './pubkey';\nimport {SystemController} from './system-controller';\nimport {Transaction, TxOperation} from './transaction-controller';\nimport type {TxnSignature} from './transaction-controller';\nimport {sendAndconfmTx} from './util/send-and-confm-tx';\nimport type {Connection} from './connection';\n\n/**\n * Some amount of tokens\n */\nexport class TokenCount extends BN {\n  /**\n   * Convert to Buffer representation\n   */\n  toBuffer(): Buffer {\n    const a = super.toArray().reverse();\n    const b = Buffer.from(a);\n    if (b.length === 8) {\n      return b;\n    }\n    assert(b.length < 8, 'TokenCount too large');\n\n    const zeroPad = Buffer.alloc(8);\n    b.copy(zeroPad);\n    return zeroPad;\n  }\n\n  /**\n   * Construct a TokenCount from Buffer representation\n   */\n  static fromBuffer(buffer: Buffer): TokenCount {\n    assert(buffer.length === 8, `Invalid buffer length: ${buffer.length}`);\n    return new BN(\n      [...buffer]\n        .reverse()\n        .map(i => `00${i.toString(16)}`.slice(-2))\n        .join(''),\n      16,\n    );\n  }\n}\n\n/**\n * Information about a token\n */\ntype TokenDetail = {|\n  /**\n   * Total supply of tokens\n   */\n  supply: TokenCount,\n\n  /**\n   * Number of base 10 digits to the right of the decimal place\n   */\n  decimals: number,\n\n  /**\n   * Descriptive name of this token\n   */\n  name: string,\n\n  /**\n   * Symbol for this token\n   */\n  symbol: string,\n|};\n\n/**\n * @private\n */\nconst TokenDetailLayout = BufferLayout.struct([\n  Layout.uint64('supply'),\n  BufferLayout.u8('decimals'),\n  Layout.rustString('name'),\n  Layout.rustString('symbol'),\n]);\n\n/**\n * Information about a token account\n */\ntype TokenAccountDetail = {|\n  /**\n   * The kind of token this account holds\n   */\n  token: PubKey,\n\n  /**\n   * Owner of this account\n   */\n  owner: PubKey,\n\n  /**\n   * Amount of tokens this account holds\n   */\n  amount: TokenCount,\n\n  /**\n   * The source account for the tokens.\n   *\n   * If `source` is null, the source is this account.\n   * If `source` is not null, the `amount` of tokens in this account represent\n   * an allowance of tokens that may be transferred from the source account\n   */\n  source: null | PubKey,\n\n  /**\n   * New amount of tokens this delegate account was authorized to spend\n   * If `source` is null, originalAmount is zero\n   */\n  originalAmount: TokenCount,\n|};\n\n/**\n * @private\n */\nconst TokenAccountDetailLayout = BufferLayout.struct([\n  Layout.pubKey('token'),\n  Layout.pubKey('owner'),\n  Layout.uint64('amount'),\n  BufferLayout.u8('sourceOption'),\n  Layout.pubKey('source'),\n  Layout.uint64('originalAmount'),\n]);\n\ntype TokenAndPubKey = [Token, PubKey]; // This type exists to workaround an esdoc parse error\n\n/**\n * The built-in token controller\n */\nexport const SYSTEM_TOKEN_CONTROLLER_ID = new PubKey(\n  'Token11111111111111111111111111111111111111',\n);\n\n/**\n * An ERC20-like Token\n */\nexport class Token {\n  /**\n   * @private\n   */\n  connection: Connection;\n\n  /**\n   * The public key identifying this token\n   */\n  token: PubKey;\n\n  /**\n   * Controller Identifier for the Token controller\n   */\n  controllerId: PubKey;\n\n  /**\n   * Create a Token object attached to the specific token\n   *\n   * @param connection The connection to use\n   * @param token Public key of the token\n   * @param controllerId Optional token controllerId, uses the system controllerId by default\n   */\n  constructor(\n    connection: Connection,\n    token: PubKey,\n    controllerId: PubKey = SYSTEM_TOKEN_CONTROLLER_ID,\n  ) {\n    Object.assign(this, {connection, token, controllerId});\n  }\n\n  /**\n   * Create a new Token\n   *\n   * @param connection The connection to use\n   * @param owner User account that will own the returned Token BusAccount\n   * @param supply Total supply of the new token\n   * @param name Descriptive name of this token\n   * @param symbol Symbol for this token\n   * @param decimals Location of the decimal place\n   * @param controllerId Optional token controllerId, uses the system controllerId by default\n   * @return Token object for the newly minted token, Public key of the Token BusAccount holding the total supply of new tokens\n   */\n  static async createNewToken(\n    connection: Connection,\n    owner: BusAccount,\n    supply: TokenCount,\n    name: string,\n    symbol: string,\n    decimals: number,\n    controllerId: PubKey = SYSTEM_TOKEN_CONTROLLER_ID,\n  ): Promise<TokenAndPubKey> {\n    const tokenAccount = new BusAccount();\n    const token = new Token(connection, tokenAccount.pubKey, controllerId);\n    const initialAccountPublicKey = await token.createNewAccount(owner, null);\n\n    let transaction;\n\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      Layout.uint64('supply'),\n      BufferLayout.u8('decimals'),\n      Layout.rustString('name'),\n      Layout.rustString('symbol'),\n    ]);\n\n    let data = Buffer.alloc(1024);\n    {\n      const encodeLength = dataLayout.encode(\n        {\n          instruction: 0, // NewToken instruction\n          supply: supply.toBuffer(),\n          decimals,\n          name,\n          symbol,\n        },\n        data,\n      );\n      data = data.slice(0, encodeLength);\n    }\n\n    // Allocate memory for the tokenAccount account\n    transaction = SystemController.createNewAccount(\n      owner.pubKey,\n      tokenAccount.pubKey,\n      1,\n      0,\n      1 + data.length,\n      controllerId,\n    );\n    await sendAndconfmTx(connection, transaction, owner);\n\n    transaction = new Transaction().add({\n      keys: [\n        {pubkey: tokenAccount.pubKey, isSigner: true, isDebitable: false},\n        {pubkey: initialAccountPublicKey, isSigner: false, isDebitable: true},\n      ],\n      controllerId,\n      data,\n    });\n    await sendAndconfmTx(\n      connection,\n      transaction,\n      owner,\n      tokenAccount,\n    );\n\n    return [token, initialAccountPublicKey];\n  }\n\n  /**\n   * Create a new and empty token account.\n   *\n   * This account may then be used as a `transfer()` or `approve()` destination\n   *\n   * @param owner User account that will own the new token account\n   * @param source If not null, create a delegate account that when authorized\n   *               may transfer tokens from this `source` account\n   * @return Public key of the new empty token account\n   */\n  async createNewAccount(\n    owner: BusAccount,\n    source: null | PubKey = null,\n  ): Promise<PubKey> {\n    const tokenAccount = new BusAccount();\n    let transaction;\n\n    const dataLayout = BufferLayout.struct([BufferLayout.u32('instruction')]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 1, // NewTokenAccount instruction\n      },\n      data,\n    );\n\n    // Allocate memory for the token\n    transaction = SystemController.createNewAccount(\n      owner.pubKey,\n      tokenAccount.pubKey,\n      1,\n      0,\n      1 + TokenAccountDetailLayout.span,\n      this.controllerId,\n    );\n    await sendAndconfmTx(this.connection, transaction, owner);\n\n    // Initialize the token account\n    const keys = [\n      {pubkey: tokenAccount.pubKey, isSigner: true, isDebitable: true},\n      {pubkey: owner.pubKey, isSigner: false, isDebitable: false},\n      {pubkey: this.token, isSigner: false, isDebitable: false},\n    ];\n    if (source) {\n      keys.push({pubkey: source, isSigner: false, isDebitable: false});\n    }\n    transaction = new Transaction().add({\n      keys,\n      controllerId: this.controllerId,\n      data,\n    });\n    await sendAndconfmTx(\n      this.connection,\n      transaction,\n      owner,\n      tokenAccount,\n    );\n\n    return tokenAccount.pubKey;\n  }\n\n  /**\n   * Retrieve token information\n   */\n  async fetchTokenDetail(): Promise<TokenDetail> {\n    const fetchAccountDetail = await this.connection.fetchAccountDetail(this.token);\n    if (!fetchAccountDetail.owner.equals(this.controllerId)) {\n      throw new Error(\n        `Invalid token owner: ${JSON.stringify(fetchAccountDetail.owner)}`,\n      );\n    }\n\n    const data = Buffer.from(fetchAccountDetail.data);\n\n    if (data.readUInt8(0) !== 1) {\n      throw new Error(`Invalid token data`);\n    }\n    const fetchTokenDetail = TokenDetailLayout.decode(data, 1);\n    fetchTokenDetail.supply = TokenCount.fromBuffer(fetchTokenDetail.supply);\n    return fetchTokenDetail;\n  }\n\n  /**\n   * Retrieve account information\n   *\n   * @param account Public key of the token account\n   */\n  async fetchAccountDetail(account: PubKey): Promise<TokenAccountDetail> {\n    const fetchAccountDetail = await this.connection.fetchAccountDetail(account);\n    if (!fetchAccountDetail.owner.equals(this.controllerId)) {\n      throw new Error(`Invalid token account owner`);\n    }\n\n    const data = Buffer.from(fetchAccountDetail.data);\n    if (data.readUInt8(0) !== 2) {\n      throw new Error(`Invalid token account data`);\n    }\n    const tokenAccountInfo = TokenAccountDetailLayout.decode(data, 1);\n\n    tokenAccountInfo.token = new PubKey(tokenAccountInfo.token);\n    tokenAccountInfo.owner = new PubKey(tokenAccountInfo.owner);\n    tokenAccountInfo.amount = TokenCount.fromBuffer(tokenAccountInfo.amount);\n    if (tokenAccountInfo.sourceOption === 0) {\n      tokenAccountInfo.source = null;\n      tokenAccountInfo.originalAmount = new TokenCount();\n    } else {\n      tokenAccountInfo.source = new PubKey(tokenAccountInfo.source);\n      tokenAccountInfo.originalAmount = TokenCount.fromBuffer(\n        tokenAccountInfo.originalAmount,\n      );\n    }\n\n    if (!tokenAccountInfo.token.equals(this.token)) {\n      throw new Error(\n        `Invalid token account token: ${JSON.stringify(\n          tokenAccountInfo.token,\n        )} !== ${JSON.stringify(this.token)}`,\n      );\n    }\n    return tokenAccountInfo;\n  }\n\n  /**\n   * Transfer tokens to another account\n   *\n   * @param owner Owner of the source token account\n   * @param source Source token account\n   * @param destination Destination token account\n   * @param amount Number of tokens to transfer\n   */\n  async transfer(\n    owner: BusAccount,\n    source: PubKey,\n    destination: PubKey,\n    amount: number | TokenCount,\n  ): Promise<?TxnSignature> {\n    return await sendAndconfmTx(\n      this.connection,\n      new Transaction().add(\n        await this.transferOperation(\n          owner.pubKey,\n          source,\n          destination,\n          amount,\n        ),\n      ),\n      owner,\n    );\n  }\n\n  /**\n   * Grant a third-party permission to transfer up the specified number of tokens from an account\n   *\n   * @param owner Owner of the source token account\n   * @param account Public key of the token account\n   * @param delegate Token account authorized to perform a transfer tokens from the source account\n   * @param amount Maximum number of tokens the delegate may transfer\n   */\n  async approve(\n    owner: BusAccount,\n    account: PubKey,\n    delegate: PubKey,\n    amount: number | TokenCount,\n  ): Promise<void> {\n    await sendAndconfmTx(\n      this.connection,\n      new Transaction().add(\n        this.approveOperation(owner.pubKey, account, delegate, amount),\n      ),\n      owner,\n    );\n  }\n\n  /**\n   * Remove approval for the transfer of any remaining tokens\n   *\n   * @param owner Owner of the source token account\n   * @param account Public key of the token account\n   * @param delegate Token account to revoke authorization from\n   */\n  revoke(\n    owner: BusAccount,\n    account: PubKey,\n    delegate: PubKey,\n  ): Promise<void> {\n    return this.approve(owner, account, delegate, 0);\n  }\n\n  /**\n   * Assign a new owner to the account\n   *\n   * @param owner Owner of the token account\n   * @param account Public key of the token account\n   * @param newOwner New owner of the token account\n   */\n  async setOwner(\n    owner: BusAccount,\n    account: PubKey,\n    newOwner: PubKey,\n  ): Promise<void> {\n    await sendAndconfmTx(\n      this.connection,\n      new Transaction().add(\n        this.setOwnerOperation(owner.pubKey, account, newOwner),\n      ),\n      owner,\n    );\n  }\n\n  /**\n   * Construct a Transfer instruction\n   *\n   * @param owner Owner of the source token account\n   * @param source Source token account\n   * @param destination Destination token account\n   * @param amount Number of tokens to transfer\n   */\n  async transferOperation(\n    owner: PubKey,\n    source: PubKey,\n    destination: PubKey,\n    amount: number | TokenCount,\n  ): Promise<TxOperation> {\n    const fetchAccountDetail = await this.fetchAccountDetail(source);\n    if (!owner.equals(fetchAccountDetail.owner)) {\n      throw new Error('BusAccount owner mismatch');\n    }\n\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      Layout.uint64('amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 2, // Transfer instruction\n        amount: new TokenCount(amount).toBuffer(),\n      },\n      data,\n    );\n\n    const keys = [\n      {pubkey: owner, isSigner: true, isDebitable: false},\n      {pubkey: source, isSigner: false, isDebitable: true},\n      {pubkey: destination, isSigner: false, isDebitable: true},\n    ];\n    if (fetchAccountDetail.source) {\n      keys.push({\n        pubkey: fetchAccountDetail.source,\n        isSigner: false,\n        isDebitable: true,\n      });\n    }\n    return new TxOperation({\n      keys,\n      controllerId: this.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Construct an Approve instruction\n   *\n   * @param owner Owner of the source token account\n   * @param account Public key of the token account\n   * @param delegate Token account authorized to perform a transfer tokens from the source account\n   * @param amount Maximum number of tokens the delegate may transfer\n   */\n  approveOperation(\n    owner: PubKey,\n    account: PubKey,\n    delegate: PubKey,\n    amount: number | TokenCount,\n  ): TxOperation {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u32('instruction'),\n      Layout.uint64('amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 3, // Approve instruction\n        amount: new TokenCount(amount).toBuffer(),\n      },\n      data,\n    );\n\n    return new TxOperation({\n      keys: [\n        {pubkey: owner, isSigner: true, isDebitable: false},\n        {pubkey: account, isSigner: false, isDebitable: true},\n        {pubkey: delegate, isSigner: false, isDebitable: true},\n      ],\n      controllerId: this.controllerId,\n      data,\n    });\n  }\n\n  /**\n   * Construct an Revoke instruction\n   *\n   * @param owner Owner of the source token account\n   * @param account Public key of the token account\n   * @param delegate Token account authorized to perform a transfer tokens from the source account\n   */\n  revokeOperation(\n    owner: PubKey,\n    account: PubKey,\n    delegate: PubKey,\n  ): TxOperation {\n    return this.approveOperation(owner, account, delegate, 0);\n  }\n\n  /**\n   * Construct a SetOwner instruction\n   *\n   * @param owner Owner of the token account\n   * @param account Public key of the token account\n   * @param newOwner New owner of the token account\n   */\n  setOwnerOperation(\n    owner: PubKey,\n    account: PubKey,\n    newOwner: PubKey,\n  ): TxOperation {\n    const dataLayout = BufferLayout.struct([BufferLayout.u32('instruction')]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 4, // SetOwner instruction\n      },\n      data,\n    );\n\n    return new TxOperation({\n      keys: [\n        {pubkey: owner, isSigner: true, isDebitable: false},\n        {pubkey: account, isSigner: false, isDebitable: true},\n        {pubkey: newOwner, isSigner: false, isDebitable: true},\n      ],\n      controllerId: this.controllerId,\n      data,\n    });\n  }\n}\n","// @flow\n\nimport {Connection} from '../connection';\nimport {sleep} from './sleep';\nimport type {TxnSignature} from '../transaction-controller';\nimport {DEFAULT_TICKS_PER_SLOT, NUM_TICKS_PER_SEC} from '../timing';\n\n/**\n * Sign, send and confirm a raw transaction\n */\nexport async function sendAndConfmNativeTxn(\n  connection: Connection,\n  rawTransaction: Buffer,\n): Promise<TxnSignature> {\n  const start = Date.now();\n  let signature = await connection.sendNativeTxn(rawTransaction);\n\n  // Wait up to a couple slots for a confirmation\n  let status = null;\n  let statusRetries = 6;\n  for (;;) {\n    status = await connection.fetchSignatureState(signature);\n    if (status) {\n      break;\n    }\n\n    // Sleep for approximately half a slot\n    await sleep((500 * DEFAULT_TICKS_PER_SLOT) / NUM_TICKS_PER_SEC);\n\n    if (--statusRetries <= 0) {\n      const duration = (Date.now() - start) / 1000;\n      throw new Error(\n        `Raw Transaction '${signature}' was not confirmed in ${duration.toFixed(\n          2,\n        )} seconds (${JSON.stringify(status)})`,\n      );\n    }\n  }\n\n  if (status && 'Ok' in status) {\n    return signature;\n  }\n\n  throw new Error(\n    `Raw transaction ${signature} failed (${JSON.stringify(status)})`,\n  );\n}\n","//@flow\n\nimport {testnetDefaultChannel} from '../../package.json';\n\n/**\n * @private\n */\nconst endpoint = {\n  edge: 'https://api.edge.testnet.bitconch.com',\n  beta: 'https://api.beta.testnet.bitconch.com',\n  stable: 'https://api.testnet.bitconch.com',\n};\n\n/**\n * Retrieves the RPC endpoint URL for the specified testnet release\n * channel\n */\nexport function testnetChannelEndpoint(channel?: string): string {\n  if (!channel) {\n    return endpoint[testnetDefaultChannel];\n  }\n\n  if (endpoint[channel]) {\n    return endpoint[channel];\n  }\n  throw new Error(`Unknown channel: ${channel}`);\n}\n"," /// @flow\nexport {BusAccount} from './bus-account';\nexport {BpfControllerLoader} from './bpfcontroller-loader';\nexport {BudgetController} from './budget-controller';\nexport {Connection} from './connection';\nexport {ControllerLoader} from './controller-loader';\nexport {NativeControllerLoader} from './nativecontroller-loader';\nexport {PubKey} from './pubkey';\nexport {SystemController} from './system-controller';\nexport {Token, TokenCount} from './token-controller';\nexport {Transaction, TxOperation} from './transaction-controller';\nexport {sendAndconfmTx} from './util/send-and-confm-tx';\nexport {\n  sendAndConfmNativeTxn,\n} from './util/send-and-confm-original-tx';\nexport {testnetChannelEndpoint} from './util/testnet';\n"],"names":["PubKey","value","startsWith","_bn","BN","substring","bs58","decode","byteLength","Error","pubKey","eq","encode","toBuffer","b","toArrayLike","Buffer","length","zeroPad","alloc","copy","toBase58","o","BusAccount","privateKey","_keypair","nacl","sign","keyPair","fromSecretKey","publicKey","secretKey","NUM_TICKS_PER_SEC","DEFAULT_TICKS_PER_SLOT","property","BufferLayout","uint64","rustString","rsl","_decode","bind","_encode","buffer","offset","data","chars","toString","str","from","decodeLength","bytes","len","size","elem","shift","encodeLength","rem_len","push","PACKET_DATA_SIZE","TxOperation","opts","Object","assign","Transaction","signatures","signature","items","forEach","item","operations","concat","recentPackagehash","keys","map","numRequiredSignatures","numCreditOnlySignedAccounts","numCreditOnlyUnsignedAccounts","programIds","instruction","keySignerPair","keyStr","pubkey","includes","isSigner","isDebitable","controllerId","keyCount","shortvec","keyIndicesCount","dataCount","programIdIndex","indexOf","keyIndices","keyObj","dataLength","invariant","keyIndex","instructionCount","instructionBuffer","instructionBufferLength","instructionLayout","slice","signDataLayout","Layout","transaction","key","signData","signPartial","partialSigners","accountOrPublicKey","_fetchSignData","index","detached","signer","findIndex","sigpair","equals","signatureCount","transactionLength","wireTransaction","PUBKEY_LENGTH","SIGNATURE_LENGTH","isCreditDebit","i","numKeys","byteArray","accountCount","accounts","account","programIndex","accountIndexCount","accountIndex","sigPubkeyPair","instructionData","j","some","sleep","ms","Promise","resolve","setTimeout","createRpcReq","url","server","jayson","request","callback","options","method","body","headers","fetch","res","text","args","reject","err","response","FetchBalanceRpcResult","struct","jsonrpc","literal","id","error","result","FetchReputationRpcResult","jsonRpcResult","resultDescription","jsonRpcVersion","union","AccountDetailResult","executable","owner","difs","reputations","fetchAccountDetailRpcResult","AccountNoticeResult","subscription","ControllerAccountDetailResult","ControllerAccountNoticeResult","ConfmTxnRpcResult","FetchRoundLeader","GetClusterNodes","list","gossip","tpu","rpc","GetClusterNodes_015","GetEpochVoteAccounts","votePubkey","nodePubkey","stake","commission","FetchSignatureStateRpcResult","Ok","Err","FetchTxnAmountRpcResult","GetTotalSupplyRpcResult","FetchRecentBlockhash","difsPerSignature","maxDifsPerSignature","minDifsPerSignature","targetDifsPerSignature","targetSignaturesPerSlot","GetRecentBlockhash_015","ReqDroneRpcResult","ReqReputationRpcResult","SendTxnRpcResult","Connection","endpoint","urlParse","_rpcReq","href","_blockhashInfo","seconds","transactionSignatures","protocol","host","port","String","Number","_rpcWebSock","RpcWebSocketClient","urlFormat","autoconnect","max_reconnects","Infinity","on","_wsOnOpen","_wsOnErr","_wsOnClose","_wsOnAccountNotice","_wsOnProgramAccountNotification","unsafeRes","message","assert","res_015","console","log","node","undefined","blockhash","feeCalculator","to","amount","signers","Date","getSeconds","_disableBlockhashCaching","attempts","startTime","now","fetchRecentBlockhash","serialize","sendNativeTxn","rawTransaction","_rpcWebSockConnected","_updateSubscriptions","code","accountKeys","_accountChangeSubscriptions","programKeys","_controllerAccountChangeSubscriptions","close","subscriptionId","connect","call","notification","sub","_accountChangeSubscriptionCounter","accountId","fetchAccountDetail","_controllerAccountChangeSubscriptionCounter","sendAndconfmTx","connection","sendRetries","start","sendTxn","status","statusRetries","fetchSignatureState","duration","toFixed","JSON","stringify","Math","random","SystemController","createNewAccount","space","dataLayout","span","add","ControllerLoader","payer","controller","chunkSize","array","transactions","all","BpfControllerLoader","elf","load","serializePayment","payment","toData","writeUInt32LE","serializeTime","when","iso","date","pad","number","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","write","serializeCond","condition","type","BudgetController","pos","conditions","trimmedData","conditionData","paymentData","condition1","condition2","whenData","NativeControllerLoader","controllerName","TokenCount","a","reverse","join","TokenDetailLayout","TokenAccountDetailLayout","SYSTEM_TOKEN_CONTROLLER_ID","Token","token","source","tokenAccount","readUInt8","fetchTokenDetail","supply","fromBuffer","tokenAccountInfo","sourceOption","originalAmount","destination","transferOperation","delegate","approveOperation","approve","newOwner","setOwnerOperation","name","symbol","decimals","initialAccountPublicKey","sendAndConfmNativeTxn","edge","beta","stable","testnetChannelEndpoint","channel","testnetDefaultChannel"],"mappings":"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"}