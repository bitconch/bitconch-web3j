15646351636f90cfa9228d74a0cf876a
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _tweetnacl = _interopRequireDefault(require("tweetnacl"));

var _busAccount = require("../src/bus-account");

var _pubkey = require("../src/pubkey");

var _transactionController = require("../src/transaction-controller");

var _systemController = require("../src/system-controller");

test('signPartial', function () {
  var account1 = new _busAccount.BusAccount();
  var account2 = new _busAccount.BusAccount();
  var recentPackagehash = account1.pubKey.toBase58(); // Fake recentPackagehash

  var transfer = _systemController.SystemController.transfer(account1.pubKey, account2.pubKey, 123);

  var transaction = new _transactionController.Transaction({
    recentPackagehash: recentPackagehash
  }).add(transfer);
  transaction.sign(account1, account2);
  var partialTransaction = new _transactionController.Transaction({
    recentPackagehash: recentPackagehash
  }).add(transfer);
  partialTransaction.signPartial(account1, account2.pubKey);
  expect(partialTransaction.signatures[1].signature).toBeNull();
  partialTransaction.addSigner(account2);
  expect(partialTransaction).toEqual(transaction);
});
test('transfer signatures', function () {
  var account1 = new _busAccount.BusAccount();
  var account2 = new _busAccount.BusAccount();
  var recentPackagehash = account1.pubKey.toBase58(); // Fake recentPackagehash

  var transfer1 = _systemController.SystemController.transfer(account1.pubKey, account2.pubKey, 123);

  var transfer2 = _systemController.SystemController.transfer(account2.pubKey, account1.pubKey, 123);

  var orgTransaction = new _transactionController.Transaction({
    recentPackagehash: recentPackagehash
  }).add(transfer1, transfer2);
  orgTransaction.sign(account1, account2);
  var newTransaction = new _transactionController.Transaction({
    recentPackagehash: orgTransaction.recentPackagehash,
    signatures: orgTransaction.signatures
  }).add(transfer1, transfer2);
  expect(newTransaction).toEqual(orgTransaction);
});
test('dedup signatures', function () {
  var account1 = new _busAccount.BusAccount();
  var account2 = new _busAccount.BusAccount();
  var recentPackagehash = account1.pubKey.toBase58(); // Fake recentPackagehash

  var transfer1 = _systemController.SystemController.transfer(account1.pubKey, account2.pubKey, 123);

  var transfer2 = _systemController.SystemController.transfer(account1.pubKey, account2.pubKey, 123);

  var orgTransaction = new _transactionController.Transaction({
    recentPackagehash: recentPackagehash
  }).add(transfer1, transfer2);
  orgTransaction.sign(account1);
});
test('parse wire format and serialize', function () {
  var keypair = _tweetnacl["default"].sign.keyPair.fromSeed(Uint8Array.from(Array(32).fill(8)));

  var sender = new _busAccount.BusAccount(Buffer.from(keypair.secretKey)); // Arbitrary known account

  var recentPackagehash = 'EETubP5AKHgjPAhzPAFcb8BAY1hMH639CWCFTqi3hq1k'; // Arbitrary known recentPackagehash

  var recipient = new _pubkey.PubKey('J3dxNj7nDRRqRRXuEMynDG57DkZK4jYRuv3Garmb1i99'); // Arbitrary known public key

  var transfer = _systemController.SystemController.transfer(sender.pubKey, recipient, 49);

  var expectedTransaction = new _transactionController.Transaction({
    recentPackagehash: recentPackagehash
  }).add(transfer);
  expectedTransaction.sign(sender);
  var wireTransaction = Buffer.from([1, 47, 50, 66, 17, 219, 90, 187, 49, 40, 77, 8, 58, 129, 51, 76, 13, 206, 126, 157, 189, 188, 53, 174, 42, 80, 4, 4, 212, 55, 67, 171, 34, 224, 81, 68, 230, 120, 117, 204, 241, 167, 152, 74, 141, 132, 73, 166, 217, 173, 27, 75, 62, 171, 160, 100, 159, 116, 164, 45, 185, 64, 0, 72, 4, 1, 0, 2, 3, 19, 152, 246, 44, 109, 26, 69, 124, 81, 186, 106, 75, 95, 61, 189, 47, 105, 252, 169, 50, 22, 33, 141, 200, 153, 126, 65, 107, 209, 125, 147, 202, 253, 67, 159, 204, 182, 103, 39, 242, 137, 197, 198, 222, 59, 196, 168, 254, 93, 213, 215, 119, 112, 188, 143, 241, 92, 62, 238, 220, 177, 74, 243, 252, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 196, 154, 231, 118, 3, 120, 32, 84, 241, 122, 157, 236, 234, 67, 180, 68, 235, 160, 237, 177, 44, 111, 29, 49, 198, 224, 228, 168, 75, 240, 82, 235, 1, 2, 2, 0, 1, 12, 2, 0, 0, 0, 49, 0, 0, 0, 0, 0, 0, 0]);

  var tx = _transactionController.Transaction.from(wireTransaction);

  expect(tx).toEqual(expectedTransaction);
  expect(wireTransaction).toEqual(expectedTransaction.serialize());
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYW5zYWN0aW9uLnRlc3QuanMiXSwibmFtZXMiOlsidGVzdCIsImFjY291bnQxIiwiQnVzQWNjb3VudCIsImFjY291bnQyIiwicmVjZW50UGFja2FnZWhhc2giLCJwdWJLZXkiLCJ0b0Jhc2U1OCIsInRyYW5zZmVyIiwiU3lzdGVtQ29udHJvbGxlciIsInRyYW5zYWN0aW9uIiwiVHJhbnNhY3Rpb24iLCJhZGQiLCJzaWduIiwicGFydGlhbFRyYW5zYWN0aW9uIiwic2lnblBhcnRpYWwiLCJleHBlY3QiLCJzaWduYXR1cmVzIiwic2lnbmF0dXJlIiwidG9CZU51bGwiLCJhZGRTaWduZXIiLCJ0b0VxdWFsIiwidHJhbnNmZXIxIiwidHJhbnNmZXIyIiwib3JnVHJhbnNhY3Rpb24iLCJuZXdUcmFuc2FjdGlvbiIsImtleXBhaXIiLCJuYWNsIiwia2V5UGFpciIsImZyb21TZWVkIiwiVWludDhBcnJheSIsImZyb20iLCJBcnJheSIsImZpbGwiLCJzZW5kZXIiLCJCdWZmZXIiLCJzZWNyZXRLZXkiLCJyZWNpcGllbnQiLCJQdWJLZXkiLCJleHBlY3RlZFRyYW5zYWN0aW9uIiwid2lyZVRyYW5zYWN0aW9uIiwidHgiLCJzZXJpYWxpemUiXSwibWFwcGluZ3MiOiI7Ozs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQUEsSUFBSSxDQUFDLGFBQUQsRUFBZ0IsWUFBTTtBQUN4QixNQUFNQyxRQUFRLEdBQUcsSUFBSUMsc0JBQUosRUFBakI7QUFDQSxNQUFNQyxRQUFRLEdBQUcsSUFBSUQsc0JBQUosRUFBakI7QUFDQSxNQUFNRSxpQkFBaUIsR0FBR0gsUUFBUSxDQUFDSSxNQUFULENBQWdCQyxRQUFoQixFQUExQixDQUh3QixDQUc4Qjs7QUFDdEQsTUFBTUMsUUFBUSxHQUFHQyxtQ0FBaUJELFFBQWpCLENBQ2ZOLFFBQVEsQ0FBQ0ksTUFETSxFQUVmRixRQUFRLENBQUNFLE1BRk0sRUFHZixHQUhlLENBQWpCOztBQU1BLE1BQU1JLFdBQVcsR0FBRyxJ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Mk1sQyxFQTNNa0MsRUE0TWxDLENBNU1rQyxFQTZNbEMsQ0E3TWtDLEVBOE1sQyxDQTlNa0MsRUErTWxDLENBL01rQyxFQWdObEMsRUFoTmtDLEVBaU5sQyxDQWpOa0MsRUFrTmxDLENBbE5rQyxFQW1ObEMsQ0FuTmtDLEVBb05sQyxDQXBOa0MsRUFxTmxDLENBck5rQyxFQXNObEMsQ0F0TmtDLEVBdU5sQyxDQXZOa0MsQ0FBWixDQUF4Qjs7QUF5TkEsTUFBTVUsRUFBRSxHQUFHOUIsbUNBQVlvQixJQUFaLENBQWlCUyxlQUFqQixDQUFYOztBQUVBeEIsRUFBQUEsTUFBTSxDQUFDeUIsRUFBRCxDQUFOLENBQVdwQixPQUFYLENBQW1Ca0IsbUJBQW5CO0FBQ0F2QixFQUFBQSxNQUFNLENBQUN3QixlQUFELENBQU4sQ0FBd0JuQixPQUF4QixDQUFnQ2tCLG1CQUFtQixDQUFDRyxTQUFwQixFQUFoQztBQUNELENBMU9HLENBQUoiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xuaW1wb3J0IG5hY2wgZnJvbSAndHdlZXRuYWNsJztcblxuaW1wb3J0IHtCdXNBY2NvdW50fSBmcm9tICcuLi9zcmMvYnVzLWFjY291bnQnO1xuaW1wb3J0IHtQdWJLZXl9IGZyb20gJy4uL3NyYy9wdWJrZXknO1xuaW1wb3J0IHtUcmFuc2FjdGlvbn0gZnJvbSAnLi4vc3JjL3RyYW5zYWN0aW9uLWNvbnRyb2xsZXInO1xuaW1wb3J0IHtTeXN0ZW1Db250cm9sbGVyfSBmcm9tICcuLi9zcmMvc3lzdGVtLWNvbnRyb2xsZXInO1xuXG50ZXN0KCdzaWduUGFydGlhbCcsICgpID0+IHtcbiAgY29uc3QgYWNjb3VudDEgPSBuZXcgQnVzQWNjb3VudCgpO1xuICBjb25zdCBhY2NvdW50MiA9IG5ldyBCdXNBY2NvdW50KCk7XG4gIGNvbnN0IHJlY2VudFBhY2thZ2VoYXNoID0gYWNjb3VudDEucHViS2V5LnRvQmFzZTU4KCk7IC8vIEZha2UgcmVjZW50UGFja2FnZWhhc2hcbiAgY29uc3QgdHJhbnNmZXIgPSBTeXN0ZW1Db250cm9sbGVyLnRyYW5zZmVyKFxuICAgIGFjY291bnQxLnB1YktleSxcbiAgICBhY2NvdW50Mi5wdWJLZXksXG4gICAgMTIzLFxuICApO1xuXG4gIGNvbnN0IHRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHtyZWNlbnRQYWNrYWdlaGFzaH0pLmFkZCh0cmFuc2Zlcik7XG4gIHRyYW5zYWN0aW9uLnNpZ24oYWNjb3VudDEsIGFjY291bnQyKTtcblxuICBjb25zdCBwYXJ0aWFsVHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24oe3JlY2VudFBhY2thZ2VoYXNofSkuYWRkKHRyYW5zZmVyKTtcbiAgcGFydGlhbFRyYW5zYWN0aW9uLnNpZ25QYXJ0aWFsKGFjY291bnQxLCBhY2NvdW50Mi5wdWJLZXkpO1xuICBleHBlY3QocGFydGlhbFRyYW5zYWN0aW9uLnNpZ25hdHVyZXNbMV0uc2lnbmF0dXJlKS50b0JlTnVsbCgpO1xuICBwYXJ0aWFsVHJhbnNhY3Rpb24uYWRkU2lnbmVyKGFjY291bnQyKTtcblxuICBleHBlY3QocGFydGlhbFRyYW5zYWN0aW9uKS50b0VxdWFsKHRyYW5zYWN0aW9uKTtcbn0pO1xuXG50ZXN0KCd0cmFuc2ZlciBzaWduYXR1cmVzJywgKCkgPT4ge1xuICBjb25zdCBhY2NvdW50MSA9IG5ldyBCdXNBY2NvdW50KCk7XG4gIGNvbnN0IGFjY291bnQyID0gbmV3IEJ1c0FjY291bnQoKTtcbiAgY29uc3QgcmVjZW50UGFja2FnZWhhc2ggPSBhY2NvdW50MS5wdWJLZXkudG9CYXNlNTgoKTsgLy8gRmFrZSByZWNlbnRQYWNrYWdlaGFzaFxuICBjb25zdCB0cmFuc2ZlcjEgPSBTeXN0ZW1Db250cm9sbGVyLnRyYW5zZmVyKFxuICAgIGFjY291bnQxLnB1YktleSxcbiAgICBhY2NvdW50Mi5wdWJLZXksXG4gICAgMTIzLFxuICApO1xuICBjb25zdCB0cmFuc2ZlcjIgPSBTeXN0ZW1Db250cm9sbGVyLnRyYW5zZmVyKFxuICAgIGFjY291bnQyLnB1YktleSxcbiAgICBhY2NvdW50MS5wdWJLZXksXG4gICAgMTIzLFxuICApO1xuXG4gIGNvbnN0IG9yZ1RyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHtyZWNlbnRQYWNrYWdlaGFzaH0pLmFkZChcbiAgICB0cmFuc2ZlcjEsXG4gICAgdHJhbnNmZXIyLFxuICApO1xuICBvcmdUcmFuc2FjdGlvbi5zaWduKGFjY291bnQxLCBhY2NvdW50Mik7XG5cbiAgY29uc3QgbmV3VHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24oe1xuICAgIHJlY2VudFBhY2thZ2VoYXNoOiBvcmdUcmFuc2FjdGlvbi5yZWNlbnRQYWNrYWdlaGFzaCxcbiAgICBzaWduYXR1cmVzOiBvcmdUcmFuc2FjdGlvbi5zaWduYXR1cmVzLFxuICB9KS5hZGQodHJhbnNmZXIxLCB0cmFuc2ZlcjIpO1xuXG4gIGV4cGVjdChuZXdUcmFuc2FjdGlvbikudG9FcXVhbChvcmdUcmFuc2FjdGlvbik7XG59KTtcblxudGVzdCgnZGVkdXAgc2lnbmF0dXJlcycsICgpID0+IHtcbiAgY29uc3QgYWNjb3VudDEgPSBuZXcgQnVzQWNjb3VudCgpO1xuICBjb25zdCBhY2NvdW50MiA9IG5ldyBCdXNBY2NvdW50KCk7XG4gIGNvbnN0IHJlY2VudFBhY2thZ2VoYXNoID0gYWNjb3VudDEucHViS2V5LnRvQmFzZTU4KCk7IC8vIEZha2UgcmVjZW50UGFja2FnZWhhc2hcbiAgY29uc3QgdHJhbnNmZXIxID0gU3lzdGVtQ29udHJvbGxlci50cmFuc2ZlcihcbiAgICBhY2NvdW50MS5wdWJLZXksXG4gICAgYWNjb3VudDIucHViS2V5LFxuICAgIDEyMyxcbiAgKTtcbiAgY29uc3QgdHJhbnNmZXIyID0gU3lzdGVtQ29udHJvbGxlci50cmFuc2ZlcihcbiAgICBhY2NvdW50MS5wdWJLZXksXG4gICAgYWNjb3VudDIucHViS2V5LFxuICAgIDEyMyxcbiAgKTtcblxuICBjb25zdCBvcmdUcmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih7cmVjZW50UGFja2FnZWhhc2h9KS5hZGQoXG4gICAgdHJhbnNmZXIxLFxuICAgIHRyYW5zZmVyMixcbiAgKTtcbiAgb3JnVHJhbnNhY3Rpb24uc2lnbihhY2NvdW50MSk7XG59KTtcblxudGVzdCgncGFyc2Ugd2lyZSBmb3JtYXQgYW5kIHNlcmlhbGl6ZScsICgpID0+IHtcbiAgY29uc3Qga2V5cGFpciA9IG5hY2wuc2lnbi5rZXlQYWlyLmZyb21TZWVkKFxuICAgIFVpbnQ4QXJyYXkuZnJvbShBcnJheSgzMikuZmlsbCg4KSksXG4gICk7XG4gIGNvbnN0IHNlbmRlciA9IG5ldyBCdXNBY2NvdW50KEJ1ZmZlci5mcm9tKGtleXBhaXIuc2VjcmV0S2V5KSk7IC8vIEFyYml0cmFyeSBrbm93biBhY2NvdW50XG4gIGNvbnN0IHJlY2VudFBhY2thZ2VoYXNoID0gJ0VFVHViUDVBS0hnalBBaHpQQUZjYjhCQVkxaE1INjM5Q1dDRlRxaTNocTFrJzsgLy8gQXJiaXRyYXJ5IGtub3duIHJlY2VudFBhY2thZ2VoYXNoXG4gIGNvbnN0IHJlY2lwaWVudCA9IG5ldyBQdWJLZXkoXG4gICAgJ0ozZHhOajduRFJScVJSWHVFTXluREc1N0RrWks0allSdXYzR2FybWIxaTk5JyxcbiAgKTsgLy8gQXJiaXRyYXJ5IGtub3duIHB1YmxpYyBrZXlcbiAgY29uc3QgdHJhbnNmZXIgPSBTeXN0ZW1Db250cm9sbGVyLnRyYW5zZmVyKHNlbmRlci5wdWJLZXksIHJlY2lwaWVudCwgNDkpO1xuICBjb25zdCBleHBlY3RlZFRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHtyZWNlbnRQYWNrYWdlaGFzaH0pLmFkZCh0cmFuc2Zlcik7XG4gIGV4cGVjdGVkVHJhbnNhY3Rpb24uc2lnbihzZW5kZXIpO1xuXG4gIGNvbnN0IHdpcmVUcmFuc2FjdGlvbiA9IEJ1ZmZlci5mcm9tKFtcbiAgICAxLFxuICAgIDQ3LFxuICAgIDUwLFxuICAgIDY2LFxuICAgIDE3LFxuICAgIDIxOSxcbiAgICA5MCxcbiAgICAxODcsXG4gICAgNDksXG4gICAgNDAsXG4gICAgNzcsXG4gICAgOCxcbiAgICA1OCxcbiAgICAxMjksXG4gICAgNTEsXG4gICAgNzYsXG4gICAgMTMsXG4gICAgMjA2LFxuICAgIDEyNixcbiAgICAxNTcsXG4gICAgMTg5LFxuICAgIDE4OCxcbiAgICA1MyxcbiAgICAxNzQsXG4gICAgNDIsXG4gICAgODAsXG4gICAgNCxcbiAgICA0LFxuICAgIDIxMixcbiAgICA1NSxcbiAgICA2NyxcbiAgICAxNzEsXG4gICAgMzQsXG4gICAgMjI0LFxuICAgIDgxLFxuICAgIDY4LFxuICAgIDIzMCxcbiAgICAxMjAsXG4gICAgMTE3LFxuICAgIDIwNCxcbiAgICAyNDEsXG4gICAgMTY3LFxuICAgIDE1MixcbiAgICA3NCxcbiAgICAxNDEsXG4gICAgMTMyLFxuICAgIDczLFxuICAgIDE2NixcbiAgICAyMTcsXG4gICAgMTczLFxuICAgIDI3LFxuICAgIDc1LFxuICAgIDYyLFxuICAgIDE3MSxcbiAgICAxNjAsXG4gICAgMTAwLFxuICAgIDE1OSxcbiAgICAxMTYsXG4gICAgMTY0LFxuICAgIDQ1LFxuICAgIDE4NSxcbiAgICA2NCxcbiAgICAwLFxuICAgIDcyLFxuICAgIDQsXG4gICAgMSxcbiAgICAwLFxuICAgIDIsXG4gICAgMyxcbiAgICAxOSxcbiAgICAxNTIsXG4gICAgMjQ2LFxuICAgIDQ0LFxuICAgIDEwOSxcbiAgICAyNixcbiAgICA2OSxcbiAgICAxMjQsXG4gICAgODEsXG4gICAgMTg2LFxuICAgIDEwNixcbiAgICA3NSxcbiAgICA5NSxcbiAgICA2MSxcbiAgICAxODksXG4gICAgNDcsXG4gICAgMTA1LFxuICAgIDI1MixcbiAgICAxNjksXG4gICAgNTAsXG4gICAgMjIsXG4gICAgMzMsXG4gICAgMTQxLFxuICAgIDIwMCxcbiAgICAxNTMsXG4gICAgMTI2LFxuICAgIDY1LFxuICAgIDEwNyxcbiAgICAyMDksXG4gICAgMTI1LFxuICAgIDE0NyxcbiAgICAyMDIsXG4gICAgMjUzLFxuICAgIDY3LFxuICAgIDE1OSxcbiAgICAyMDQsXG4gICAgMTgyLFxuICAgIDEwMyxcbiAgICAzOSxcbiAgICAyNDIsXG4gICAgMTM3LFxuICAgIDE5NyxcbiAgICAxOTgsXG4gICAgMjIyLFxuICAgIDU5LFxuICAgIDE5NixcbiAgICAxNjgsXG4gICAgMjU0LFxuICAgIDkzLFxuICAgIDIxMyxcbiAgICAyMTUsXG4gICAgMTE5LFxuICAgIDExMixcbiAgICAxODgsXG4gICAgMTQzLFxuICAgIDI0MSxcbiAgICA5MixcbiAgICA2MixcbiAgICAyMzgsXG4gICAgMjIwLFxuICAgIDE3NyxcbiAgICA3NCxcbiAgICAyNDMsXG4gICAgMjUyLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAxOTYsXG4gICAgMTU0LFxuICAgIDIzMSxcbiAgICAxMTgsXG4gICAgMyxcbiAgICAxMjAsXG4gICAgMzIsXG4gICAgODQsXG4gICAgMjQxLFxuICAgIDEyMixcbiAgICAxNTcsXG4gICAgMjM2LFxuICAgIDIzNCxcbiAgICA2NyxcbiAgICAxODAsXG4gICAgNjgsXG4gICAgMjM1LFxuICAgIDE2MCxcbiAgICAyMzcsXG4gICAgMTc3LFxuICAgIDQ0LFxuICAgIDExMSxcbiAgICAyOSxcbiAgICA0OSxcbiAgICAxOTgsXG4gICAgMjI0LFxuICAgIDIyOCxcbiAgICAxNjgsXG4gICAgNzUsXG4gICAgMjQwLFxuICAgIDgyLFxuICAgIDIzNSxcbiAgICAxLFxuICAgIDIsXG4gICAgMixcbiAgICAwLFxuICAgIDEsXG4gICAgMTIsXG4gICAgMixcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICA0OSxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICBdKTtcbiAgY29uc3QgdHggPSBUcmFuc2FjdGlvbi5mcm9tKHdpcmVUcmFuc2FjdGlvbik7XG5cbiAgZXhwZWN0KHR4KS50b0VxdWFsKGV4cGVjdGVkVHJhbnNhY3Rpb24pO1xuICBleHBlY3Qod2lyZVRyYW5zYWN0aW9uKS50b0VxdWFsKGV4cGVjdGVkVHJhbnNhY3Rpb24uc2VyaWFsaXplKCkpO1xufSk7XG4iXX0=